<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MYP Design Rubric Explorer</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
* { box-sizing:border-box; margin:0; padding:0; }
:root {
  --bg:#f7f4ef; --surface:#fff; --surface2:#edeae4; --border:#ddd8cf;
  --text:#111; --muted:#333; --dim:#555;
  --ca:#29a8d4; --ca-bg:#e4f5fb;
  --cb:#d49800; --cb-bg:#fef3c7;
  --cc:#28a85e; --cc-bg:#e2f7ec;
  --cd:#e03c3c; --cd-bg:#fdeaea;
  --l1-bg:#fde8f0; --l1:#9a1548; --l1-bd:#f4aac8; --l1-bg-tbl:rgba(253,232,240,0.55);
  --l2-bg:#e2f7ec; --l2:#146832; --l2-bd:#82d8a4; --l2-bg-tbl:rgba(226,247,236,0.55);
  --l3-bg:#e4f5fb; --l3:#0e5878; --l3-bd:#7ecce8; --l3-bg-tbl:rgba(228,245,251,0.55);
  --l4-bg:#f0eaff; --l4:#4a18a8; --l4-bd:#b898f2; --l4-bg-tbl:rgba(240,234,255,0.55);
}
body { background:var(--bg); color:var(--text); font-family:'Nunito',sans-serif; font-size:17px; line-height:1.65; min-height:100vh; }

/* HEADER */
header { background:var(--surface); border-bottom:3px solid var(--border); padding:18px 36px; display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
.hdr-left { display:flex; align-items:center; gap:14px; }
.hdr-icon { font-size:36px; line-height:1; }
.hdr-title { font-size:24px; font-weight:900; color:var(--text); }
.hdr-sub { font-size:14px; font-weight:700; color:var(--muted); margin-top:2px; }
.hdr-btns { display:flex; gap:10px; flex-wrap:wrap; }
.prog-btn { display:flex; align-items:center; gap:8px; padding:11px 20px; border-radius:50px; border:2.5px solid var(--l2-bd); background:var(--l2-bg); cursor:pointer; font-size:14px; font-weight:900; color:var(--l2); font-family:'Nunito',sans-serif; transition:all .15s; }
.prog-btn:hover,.prog-btn.active { background:var(--l2); color:#fff; border-color:var(--l2); }
.diff-btn { display:flex; align-items:center; gap:8px; padding:11px 20px; border-radius:50px; border:2.5px solid var(--l4-bd); background:var(--l4-bg); cursor:pointer; font-size:14px; font-weight:900; color:var(--l4); font-family:'Nunito',sans-serif; transition:all .15s; }
.diff-btn:hover,.diff-btn.active { background:var(--l4); color:#fff; border-color:var(--l4); }

/* LAYOUT */
.layout { display:grid; grid-template-columns:295px 1fr; min-height:calc(100vh - 78px); }

/* SIDEBAR */
.sidebar { background:var(--surface); border-right:3px solid var(--border); padding:22px 16px; display:flex; flex-direction:column; gap:20px; position:sticky; top:0; height:calc(100vh - 78px); overflow-y:auto; }
.sidebar::-webkit-scrollbar { width:4px; } .sidebar::-webkit-scrollbar-thumb { background:var(--border); border-radius:4px; }
.flabel { font-size:11px; font-weight:900; letter-spacing:.12em; text-transform:uppercase; color:var(--dim); margin-bottom:8px; }
.crit-btn { display:flex; align-items:center; gap:10px; padding:11px 13px; border-radius:12px; border:2.5px solid transparent; background:transparent; cursor:pointer; width:100%; text-align:left; transition:all .15s; margin-bottom:4px; font-family:'Nunito',sans-serif; }
.crit-btn:hover { background:var(--bg); }
.cswatch { width:14px; height:14px; border-radius:4px; flex-shrink:0; }
.crit-btn[data-c="A"] .cswatch{background:var(--ca);} .crit-btn[data-c="A"].on{border-color:var(--ca);background:var(--ca-bg);}
.crit-btn[data-c="B"] .cswatch{background:var(--cb);} .crit-btn[data-c="B"].on{border-color:var(--cb);background:var(--cb-bg);}
.crit-btn[data-c="C"] .cswatch{background:var(--cc);} .crit-btn[data-c="C"].on{border-color:var(--cc);background:var(--cc-bg);}
.crit-btn[data-c="D"] .cswatch{background:var(--cd);} .crit-btn[data-c="D"].on{border-color:var(--cd);background:var(--cd-bg);}
.clabel{font-size:15px;font-weight:900;color:var(--text);} .csub{font-size:12px;font-weight:700;color:var(--muted);margin-top:1px;}
.strand-btn{display:flex;align-items:flex-start;gap:8px;padding:9px 12px;border-radius:10px;border:2px solid transparent;background:transparent;cursor:pointer;width:100%;text-align:left;transition:all .15s;margin-bottom:3px;font-family:'Nunito',sans-serif;}
.strand-btn:hover{background:var(--bg);} .strand-btn.on{background:var(--bg);border-color:var(--border);}
.snum{font-size:12px;font-weight:900;color:var(--dim);margin-top:2px;width:15px;flex-shrink:0;} .strand-btn.on .snum{color:var(--muted);}
.stxt{font-size:13px;font-weight:700;color:var(--muted);line-height:1.4;} .strand-btn.on .stxt{color:var(--text);font-weight:900;}
.grade-btn{display:flex;align-items:center;gap:10px;padding:9px 13px;border-radius:10px;border:2px solid var(--border);background:var(--bg);cursor:pointer;width:100%;text-align:left;transition:all .15s;margin-bottom:4px;font-family:'Nunito',sans-serif;font-size:14px;font-weight:700;color:var(--muted);}
.grade-btn:hover{border-color:#999;color:var(--text);} .grade-btn.on{background:var(--surface);border-color:#888;color:var(--text);font-weight:900;}
.tbox{width:18px;height:18px;border-radius:5px;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:900;flex-shrink:0;color:transparent;transition:all .15s;}
.grade-btn.on .tbox{background:var(--text);border-color:var(--text);color:#fff;}
.lvl-pills{display:flex;flex-direction:column;gap:5px;}
.lvl-pill{padding:9px 13px;border-radius:10px;border:2px solid transparent;background:var(--bg);cursor:pointer;font-size:14px;font-weight:700;font-family:'Nunito',sans-serif;color:var(--muted);transition:all .15s;text-align:left;width:100%;}
.lvl-pill:hover{border-color:var(--border);}
.lvl-pill.on[data-lv="1"]{background:var(--l1-bg);border-color:var(--l1-bd);color:var(--l1);font-weight:900;}
.lvl-pill.on[data-lv="2"]{background:var(--l2-bg);border-color:var(--l2-bd);color:var(--l2);font-weight:900;}
.lvl-pill.on[data-lv="3"]{background:var(--l3-bg);border-color:var(--l3-bd);color:var(--l3);font-weight:900;}
.lvl-pill.on[data-lv="4"]{background:var(--l4-bg);border-color:var(--l4-bd);color:var(--l4);font-weight:900;}
.vtoggle{display:flex;gap:3px;background:var(--bg);border:2px solid var(--border);border-radius:10px;padding:3px;}
.vbtn{flex:1;padding:8px 4px;border-radius:7px;border:none;background:transparent;cursor:pointer;font-size:13px;font-weight:900;color:var(--dim);transition:all .15s;font-family:'Nunito',sans-serif;}
.vbtn:hover{color:var(--text);} .vbtn.on{background:var(--surface);color:var(--text);box-shadow:0 2px 6px rgba(0,0,0,.1);}

/* MAIN */
.main{padding:30px 36px;}
.crumb{font-size:14px;font-weight:700;color:var(--dim);margin-bottom:14px;display:flex;align-items:center;gap:6px;}
.crumb strong{color:var(--text);font-weight:900;} .crumb-sep{color:var(--border);}
.sec-hdr{margin-bottom:20px;padding-bottom:16px;border-bottom:3px solid var(--border);}
.crit-tag{display:inline-flex;align-items:center;gap:6px;padding:5px 14px;border-radius:50px;font-size:13px;font-weight:900;margin-bottom:10px;border:2px solid;}
.sec-title{font-size:28px;font-weight:900;color:var(--text);line-height:1.2;}
.sec-meta{font-size:14px;font-weight:700;color:var(--muted);margin-top:6px;}

/* Key Words bar */
.cmd-key{background:var(--surface);border:2px solid var(--border);border-radius:14px;padding:14px 18px;margin-bottom:20px;display:flex;align-items:center;gap:12px;flex-wrap:wrap;}
.cmd-key-lbl{font-size:12px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.1em;flex-shrink:0;}
.cmd-key-items{display:flex;gap:6px;flex-wrap:wrap;}
.cmd-pill{display:flex;align-items:center;gap:5px;padding:5px 12px;border-radius:50px;border:2px solid;font-size:13px;font-weight:900;cursor:help;transition:transform .1s;}
.cmd-pill:hover{transform:scale(1.07);}
.cmd-pill.lv1{background:var(--l1-bg);color:var(--l1);border-color:var(--l1-bd);}
.cmd-pill.lv2{background:var(--l2-bg);color:var(--l2);border-color:var(--l2-bd);}
.cmd-pill.lv3{background:var(--l3-bg);color:var(--l3);border-color:var(--l3-bd);}
.cmd-pill.lv4{background:var(--l4-bg);color:var(--l4);border-color:var(--l4-bd);}
.cmd-key-hint{font-size:13px;font-weight:700;color:var(--muted);margin-left:4px;}

/* GRID cards */
.grid-view{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:18px;}
.rcard{border:2.5px solid;border-radius:16px;padding:20px 22px;position:relative;overflow:hidden;transition:box-shadow .15s,transform .15s;}
.rcard[data-lv="1"]{background:var(--l1-bg);border-color:var(--l1-bd);}
.rcard[data-lv="2"]{background:var(--l2-bg);border-color:var(--l2-bd);}
.rcard[data-lv="3"]{background:var(--l3-bg);border-color:var(--l3-bd);}
.rcard[data-lv="4"]{background:var(--l4-bg);border-color:var(--l4-bd);}
.rcard:hover{box-shadow:0 6px 22px rgba(0,0,0,.12);transform:translateY(-2px);}
.card-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.card-grade{font-size:13px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.05em;}
.lvl-badge{padding:4px 12px;border-radius:50px;font-size:12px;font-weight:900;border:2px solid;}
.lvl-badge.lv1{background:#fff;color:var(--l1);border-color:var(--l1-bd);}
.lvl-badge.lv2{background:#fff;color:var(--l2);border-color:var(--l2-bd);}
.lvl-badge.lv3{background:#fff;color:var(--l3);border-color:var(--l3-bd);}
.lvl-badge.lv4{background:#fff;color:var(--l4);border-color:var(--l4-bd);}
.card-txt{font-size:17px;font-weight:700;line-height:1.75;color:var(--text);}

/* TABLE */
.tbl-wrap{border:2.5px solid var(--border);border-radius:16px;overflow:hidden;overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
thead{background:var(--surface2);}
thead th{padding:14px 20px;text-align:left;font-size:13px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.06em;border-bottom:3px solid var(--border);white-space:nowrap;}
thead th.th-lv1{background:var(--l1-bg);color:var(--l1);border-bottom-color:var(--l1-bd);}
thead th.th-lv2{background:var(--l2-bg);color:var(--l2);border-bottom-color:var(--l2-bd);}
thead th.th-lv3{background:var(--l3-bg);color:var(--l3);border-bottom-color:var(--l3-bd);}
thead th.th-lv4{background:var(--l4-bg);color:var(--l4);border-bottom-color:var(--l4-bd);}
tbody tr{border-bottom:2px solid var(--border);}
tbody tr:last-child{border-bottom:none;}
tbody td{padding:18px 20px;vertical-align:top;font-size:17px;font-weight:700;line-height:1.75;color:var(--text);}
tbody td:first-child{font-weight:900;font-size:14px;color:var(--text);white-space:nowrap;background:var(--surface2);border-right:2px solid var(--border);}
tbody td.td-lv1{background:var(--l1-bg-tbl);}
tbody td.td-lv2{background:var(--l2-bg-tbl);}
tbody td.td-lv3{background:var(--l3-bg-tbl);}
tbody td.td-lv4{background:var(--l4-bg-tbl);}
.tbl-tag{display:inline-block;padding:3px 10px;border-radius:50px;font-size:12px;font-weight:900;margin-bottom:6px;border:2px solid;background:#fff;}
.tbl-tag.lv1{color:var(--l1);border-color:var(--l1-bd);}
.tbl-tag.lv2{color:var(--l2);border-color:var(--l2-bd);}
.tbl-tag.lv3{color:var(--l3);border-color:var(--l3-bd);}
.tbl-tag.lv4{color:var(--l4);border-color:var(--l4-bd);}

/* COMPARE */
.cmp-grp{margin-bottom:28px;}
.cmp-grp-title{font-size:15px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.07em;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.cmp-wrap{border:2.5px solid var(--border);border-radius:16px;overflow:hidden;overflow-x:auto;}
.cmp-grid{display:grid;min-width:600px;}
.cmp-hd{padding:13px 20px;font-size:13px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.06em;border-bottom:2px solid var(--border);text-align:center;}
.cmp-hd:not(:last-child){border-right:2px solid var(--border);}
.cmp-hd.lv1{background:var(--l1-bg);color:var(--l1);}
.cmp-hd.lv2{background:var(--l2-bg);color:var(--l2);}
.cmp-hd.lv3{background:var(--l3-bg);color:var(--l3);}
.cmp-hd.lv4{background:var(--l4-bg);color:var(--l4);}
.cmp-cell{padding:20px;font-size:17px;font-weight:700;line-height:1.75;color:var(--text);background:#fff;}
.cmp-cell:not(:last-child){border-right:2px solid var(--border);}
.cmp-cell.lv1{background:var(--l1-bg-tbl);}
.cmp-cell.lv2{background:var(--l2-bg-tbl);}
.cmp-cell.lv3{background:var(--l3-bg-tbl);}
.cmp-cell.lv4{background:var(--l4-bg-tbl);}

/* INLINE command term highlight */
.ct{font-weight:900;border-bottom:3px dotted;cursor:help;border-radius:3px;padding:1px 3px;}
.ct.lv1{color:var(--l1);background:rgba(255,255,255,0.7);border-bottom-color:var(--l1);}
.ct.lv2{color:var(--l2);background:rgba(255,255,255,0.7);border-bottom-color:var(--l2);}
.ct.lv3{color:var(--l3);background:rgba(255,255,255,0.7);border-bottom-color:var(--l3);}
.ct.lv4{color:var(--l4);background:rgba(255,255,255,0.7);border-bottom-color:var(--l4);}

/* TOOLTIP */
.tip{position:fixed;z-index:9999;border-radius:16px;padding:0;max-width:330px;pointer-events:none;opacity:0;transition:opacity .12s;box-shadow:0 10px 32px rgba(0,0,0,.35);font-family:'Nunito',sans-serif;overflow:hidden;}
.tip.show{opacity:1;}
.tip-head{padding:14px 18px 12px;}
.tip-head.lv1{background:var(--l1-bg);}
.tip-head.lv2{background:var(--l2-bg);}
.tip-head.lv3{background:var(--l3-bg);}
.tip-head.lv4{background:var(--l4-bg);}
.tip-word{font-size:20px;font-weight:900;}
.tip-head.lv1 .tip-word{color:var(--l1);}
.tip-head.lv2 .tip-word{color:var(--l2);}
.tip-head.lv3 .tip-word{color:var(--l3);}
.tip-head.lv4 .tip-word{color:var(--l4);}
.tip-lvl{font-size:11px;font-weight:900;letter-spacing:.1em;text-transform:uppercase;margin-top:2px;opacity:.7;}
.tip-head.lv1 .tip-lvl{color:var(--l1);}
.tip-head.lv2 .tip-lvl{color:var(--l2);}
.tip-head.lv3 .tip-lvl{color:var(--l3);}
.tip-head.lv4 .tip-lvl{color:var(--l4);}
.tip-body{padding:12px 18px 14px;background:#111;}
.tip-simple{font-size:14px;font-weight:800;color:#fff;margin-bottom:10px;line-height:1.5;}
.tip-ex-label{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.45);margin-bottom:5px;}
.tip-ex{font-size:13px;font-weight:700;color:rgba(255,255,255,.85);font-style:italic;line-height:1.55;}

/* SHARED MODAL BASE */
.modal-bg{position:fixed;inset:0;background:rgba(17,17,17,.5);z-index:1000;display:none;align-items:center;justify-content:center;padding:24px;backdrop-filter:blur(4px);}
.modal-bg.open{display:flex;}
.modal{background:var(--surface);border-radius:20px;border:3px solid var(--border);width:100%;max-width:840px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.22);}
.modal-hdr{padding:24px 30px 20px;border-bottom:3px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.modal-title{font-size:24px;font-weight:900;color:var(--text);}
.modal-sub{font-size:14px;font-weight:700;color:var(--muted);margin-top:3px;}
.close-x{width:36px;height:36px;border-radius:10px;border:2px solid var(--border);background:var(--bg);cursor:pointer;font-size:16px;font-weight:900;color:var(--muted);display:flex;align-items:center;justify-content:center;transition:all .15s;font-family:'Nunito',sans-serif;}
.close-x:hover{border-color:#888;color:var(--text);}
.modal-body{padding:26px 30px;}

/* COMPARE MODAL */
.sel-row{display:grid;grid-template-columns:1fr auto 1fr;gap:16px;align-items:center;margin-bottom:26px;}
.vs{font-size:20px;font-weight:900;color:var(--dim);text-align:center;}
.tsel{padding:11px 38px 11px 16px;border-radius:12px;border:2.5px solid var(--border);background:var(--bg);font-size:15px;font-weight:900;color:var(--text);cursor:pointer;font-family:'Nunito',sans-serif;appearance:none;width:100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23555' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;}
.tsel:focus{outline:none;border-color:var(--l4-bd);}
.cmp-result{display:grid;grid-template-columns:1fr 1fr;gap:18px;}
.ccard{border-radius:14px;border:2.5px solid;overflow:hidden;}
.ccard.lv1{border-color:var(--l1-bd);} .ccard.lv2{border-color:var(--l2-bd);} .ccard.lv3{border-color:var(--l3-bd);} .ccard.lv4{border-color:var(--l4-bd);}
.ccard-hd{padding:16px 20px;}
.ccard.lv1 .ccard-hd{background:var(--l1-bg);color:var(--l1);}
.ccard.lv2 .ccard-hd{background:var(--l2-bg);color:var(--l2);}
.ccard.lv3 .ccard-hd{background:var(--l3-bg);color:var(--l3);}
.ccard.lv4 .ccard-hd{background:var(--l4-bg);color:var(--l4);}
.ccard-word{font-size:24px;font-weight:900;}
.ccard-lvltag{font-size:11px;font-weight:900;letter-spacing:.1em;text-transform:uppercase;opacity:.65;margin-top:2px;}
.ccard-body{padding:18px 20px;}
.ccard-simple{font-size:16px;font-weight:800;color:var(--text);line-height:1.55;margin-bottom:14px;}
.ccard-ex-lbl{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);margin-bottom:6px;}
.ccard-ex{font-size:14px;font-weight:700;color:var(--text);line-height:1.65;padding:12px 14px;border-radius:10px;margin-bottom:10px;border:2px solid;}
.ccard.lv1 .ccard-ex{background:var(--l1-bg);border-color:var(--l1-bd);}
.ccard.lv2 .ccard-ex{background:var(--l2-bg);border-color:var(--l2-bd);}
.ccard.lv3 .ccard-ex{background:var(--l3-bg);border-color:var(--l3-bd);}
.ccard.lv4 .ccard-ex{background:var(--l4-bg);border-color:var(--l4-bd);}
.ccard-used{font-size:13px;font-weight:700;color:var(--muted);line-height:1.6;}
.ccard-used strong{color:var(--text);font-weight:900;}
.key-diff{grid-column:1/-1;margin-top:2px;padding:18px 20px;border-radius:12px;background:#fffbea;border:2.5px solid #f0d060;font-size:15px;font-weight:700;line-height:1.65;color:#2a2200;}
.key-diff strong{font-weight:900;color:#111;}

/* PROGRESSION MODAL */
.prog-modal{max-width:900px;}
.prog-selectors{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-bottom:28px;}
.prog-sel-wrap{display:flex;flex-direction:column;gap:6px;}
.prog-sel-label{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);}
.prog-sel{padding:10px 36px 10px 14px;border-radius:12px;border:2.5px solid var(--border);background:var(--bg);font-size:14px;font-weight:800;color:var(--text);cursor:pointer;font-family:'Nunito',sans-serif;appearance:none;width:100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23555' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 13px center;}
.prog-sel:focus{outline:none;border-color:var(--l4-bd);}
.prog-track{display:flex;flex-direction:column;}
.prog-step{display:grid;grid-template-columns:56px 1fr;}
.prog-spine{display:flex;flex-direction:column;align-items:center;}
.prog-dot{width:44px;height:44px;border-radius:50%;border:3px solid;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;z-index:1;transition:transform .15s;}
.prog-step:hover .prog-dot{transform:scale(1.12);}
.prog-dot.lv1{background:var(--l1-bg);border-color:var(--l1);}
.prog-dot.lv2{background:var(--l2-bg);border-color:var(--l2);}
.prog-dot.lv3{background:var(--l3-bg);border-color:var(--l3);}
.prog-dot.lv4{background:var(--l4-bg);border-color:var(--l4);}
.prog-line{width:3px;flex:1;min-height:20px;}
.prog-line.lv1{background:var(--l1-bd);}
.prog-line.lv2{background:var(--l2-bd);}
.prog-line.lv3{background:var(--l3-bd);}
.prog-line.lv4{background:var(--l4-bd);}
.prog-step:last-child .prog-line{display:none;}
.prog-content{padding:0 0 24px 18px;}
.prog-card{border-radius:14px;border:2.5px solid;overflow:hidden;transition:box-shadow .15s,transform .15s;}
.prog-card:hover{box-shadow:0 4px 18px rgba(0,0,0,.11);transform:translateX(3px);}
.prog-card.lv1{border-color:var(--l1-bd);}
.prog-card.lv2{border-color:var(--l2-bd);}
.prog-card.lv3{border-color:var(--l3-bd);}
.prog-card.lv4{border-color:var(--l4-bd);}
.prog-card-hd{padding:12px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px;}
.prog-card.lv1 .prog-card-hd{background:var(--l1-bg);}
.prog-card.lv2 .prog-card-hd{background:var(--l2-bg);}
.prog-card.lv3 .prog-card-hd{background:var(--l3-bg);}
.prog-card.lv4 .prog-card-hd{background:var(--l4-bg);}
.prog-lvl-name{font-size:16px;font-weight:900;}
.prog-card.lv1 .prog-lvl-name{color:var(--l1);}
.prog-card.lv2 .prog-lvl-name{color:var(--l2);}
.prog-card.lv3 .prog-lvl-name{color:var(--l3);}
.prog-card.lv4 .prog-lvl-name{color:var(--l4);}
.prog-score{padding:3px 10px;border-radius:50px;font-size:13px;font-weight:900;border:2px solid;background:#fff;}
.prog-card.lv1 .prog-score{color:var(--l1);border-color:var(--l1-bd);}
.prog-card.lv2 .prog-score{color:var(--l2);border-color:var(--l2-bd);}
.prog-card.lv3 .prog-score{color:var(--l3);border-color:var(--l3-bd);}
.prog-card.lv4 .prog-score{color:var(--l4);border-color:var(--l4-bd);}
.prog-card-body{padding:16px 18px;background:#fff;}
.prog-rubric{font-size:17px;font-weight:800;color:var(--text);line-height:1.6;margin-bottom:14px;}
.prog-changed{border-radius:10px;padding:12px 14px;border-left:4px solid;margin-bottom:12px;}
.prog-card.lv1 .prog-changed{background:#fdf0f6;border-color:var(--l1);}
.prog-card.lv2 .prog-changed{background:#edfaf3;border-color:var(--l2);}
.prog-card.lv3 .prog-changed{background:#eaf6fd;border-color:var(--l3);}
.prog-card.lv4 .prog-changed{background:#f3eeff;border-color:var(--l4);}
.prog-changed-lbl{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;margin-bottom:5px;}
.prog-card.lv1 .prog-changed-lbl{color:var(--l1);}
.prog-card.lv2 .prog-changed-lbl{color:var(--l2);}
.prog-card.lv3 .prog-changed-lbl{color:var(--l3);}
.prog-card.lv4 .prog-changed-lbl{color:var(--l4);}
.prog-changed-txt{font-size:15px;font-weight:700;color:var(--text);line-height:1.6;}
.prog-ex-lbl{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);margin-bottom:5px;}
.prog-ex{font-size:14px;font-weight:700;color:var(--text);line-height:1.65;padding:11px 14px;border-radius:10px;border:2px solid;font-style:italic;}
.prog-card.lv1 .prog-ex{background:var(--l1-bg);border-color:var(--l1-bd);}
.prog-card.lv2 .prog-ex{background:var(--l2-bg);border-color:var(--l2-bd);}
.prog-card.lv3 .prog-ex{background:var(--l3-bg);border-color:var(--l3-bd);}
.prog-card.lv4 .prog-ex{background:var(--l4-bg);border-color:var(--l4-bd);}

.fade{animation:fup .22s ease forwards;}
@keyframes fup{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
.empty{padding:80px;text-align:center;}
.empty p{font-size:22px;font-weight:900;color:var(--text);margin-bottom:8px;}
.empty span{font-size:15px;font-weight:700;color:var(--muted);}

@media(max-width:860px){
  .layout{grid-template-columns:1fr;}
  .sidebar{position:static;height:auto;border-right:none;border-bottom:3px solid var(--border);}
  .main{padding:20px;}
  .cmp-result{grid-template-columns:1fr;}
  .sel-row{grid-template-columns:1fr;}
  .prog-selectors{grid-template-columns:1fr;}
}

/* ── CHECKLIST BUTTON ── */
.check-btn{display:flex;align-items:center;gap:8px;padding:11px 20px;border-radius:50px;border:2.5px solid #ffb347;background:#fff8ee;cursor:pointer;font-size:14px;font-weight:900;color:#c25a00;font-family:'Nunito',sans-serif;transition:all .15s;}
.check-btn:hover,.check-btn.active{background:#c25a00;color:#fff;border-color:#c25a00;}

/* ── CHECKLIST MODAL ── */
#clBg{z-index:1100;}
.cl-modal{max-width:780px;max-height:95vh;}

/* Step wizard */
.cl-wizard{display:flex;flex-direction:column;gap:0;}
.cl-step{display:none;}
.cl-step.active{display:block;}

/* Step header */
.cl-step-hdr{text-align:center;padding:10px 0 28px;}
.cl-step-num{display:inline-block;background:#f0eaff;color:var(--l4);border:2px solid var(--l4-bd);border-radius:50px;font-size:12px;font-weight:900;padding:3px 14px;margin-bottom:10px;letter-spacing:.08em;text-transform:uppercase;}
.cl-step-title{font-size:22px;font-weight:900;color:var(--text);margin-bottom:6px;}
.cl-step-sub{font-size:15px;font-weight:700;color:var(--muted);}

/* Choice cards grid */
.cl-choices{display:grid;gap:12px;}
.cl-choices.cols2{grid-template-columns:1fr 1fr;}
.cl-choices.cols4{grid-template-columns:1fr 1fr 1fr 1fr;}
.cl-choice{border:2.5px solid var(--border);border-radius:14px;padding:16px 14px;cursor:pointer;text-align:center;transition:all .15s;background:var(--surface);position:relative;}
.cl-choice:hover{border-color:#aaa;transform:translateY(-2px);box-shadow:0 4px 14px rgba(0,0,0,.1);}
.cl-choice.sel{border-color:var(--l4);background:var(--l4-bg);transform:translateY(-2px);box-shadow:0 4px 14px rgba(74,24,168,.15);}
.cl-choice-icon{font-size:32px;margin-bottom:8px;}
.cl-choice-name{font-size:14px;font-weight:900;color:var(--text);}
.cl-choice-sub{font-size:12px;font-weight:700;color:var(--muted);margin-top:3px;}
.cl-choice.sel .cl-choice-name{color:var(--l4);}
.cl-choice.sel .cl-choice-sub{color:var(--l4);}
/* level colours for level cards */
.cl-choice[data-lv="1"]:hover,.cl-choice[data-lv="1"].sel{border-color:var(--l1);background:var(--l1-bg);}
.cl-choice[data-lv="1"].sel .cl-choice-name{color:var(--l1);}
.cl-choice[data-lv="2"]:hover,.cl-choice[data-lv="2"].sel{border-color:var(--l2);background:var(--l2-bg);}
.cl-choice[data-lv="2"].sel .cl-choice-name{color:var(--l2);}
.cl-choice[data-lv="3"]:hover,.cl-choice[data-lv="3"].sel{border-color:var(--l3);background:var(--l3-bg);}
.cl-choice[data-lv="3"].sel .cl-choice-name{color:var(--l3);}
.cl-choice[data-lv="4"]:hover,.cl-choice[data-lv="4"].sel{border-color:var(--l4);background:var(--l4-bg);}
.cl-choice[data-lv="4"].sel .cl-choice-name{color:var(--l4);}

/* Wizard nav */
.cl-nav{display:flex;justify-content:space-between;align-items:center;padding-top:24px;border-top:2px solid var(--border);margin-top:24px;}
.cl-nav-back{padding:10px 20px;border-radius:50px;border:2px solid var(--border);background:var(--bg);font-size:14px;font-weight:900;color:var(--muted);cursor:pointer;font-family:'Nunito',sans-serif;transition:all .15s;}
.cl-nav-back:hover{border-color:#888;color:var(--text);}
.cl-nav-next{padding:10px 28px;border-radius:50px;border:none;background:var(--l4);font-size:14px;font-weight:900;color:#fff;cursor:pointer;font-family:'Nunito',sans-serif;transition:all .15s;box-shadow:0 3px 12px rgba(74,24,168,.3);}
.cl-nav-next:hover{background:#3a0e88;}
.cl-nav-next:disabled{background:#ccc;box-shadow:none;cursor:not-allowed;}
.cl-dots{display:flex;gap:7px;}
.cl-dot{width:9px;height:9px;border-radius:50%;background:var(--border);transition:all .2s;}
.cl-dot.on{background:var(--l4);transform:scale(1.3);}

/* ── CHECKLIST OUTPUT STEP ── */
.cl-output{display:flex;flex-direction:column;gap:16px;}

/* Celebration banner */
.cl-banner{border-radius:16px;padding:20px 24px;text-align:center;position:relative;overflow:hidden;}
.cl-banner.lv1{background:var(--l1-bg);border:2.5px solid var(--l1-bd);}
.cl-banner.lv2{background:var(--l2-bg);border:2.5px solid var(--l2-bd);}
.cl-banner.lv3{background:var(--l3-bg);border:2.5px solid var(--l3-bd);}
.cl-banner.lv4{background:var(--l4-bg);border:2.5px solid var(--l4-bd);}
.cl-banner-icon{font-size:40px;margin-bottom:6px;}
.cl-banner-title{font-size:20px;font-weight:900;}
.cl-banner.lv1 .cl-banner-title{color:var(--l1);}
.cl-banner.lv2 .cl-banner-title{color:var(--l2);}
.cl-banner.lv3 .cl-banner-title{color:var(--l3);}
.cl-banner.lv4 .cl-banner-title{color:var(--l4);}
.cl-banner-sub{font-size:14px;font-weight:700;color:var(--muted);margin-top:4px;}

/* Game widget */
.cl-game{border-radius:16px;border:2.5px solid var(--border);overflow:hidden;}
.cl-game-hdr{padding:12px 18px;display:flex;align-items:center;justify-content:space-between;background:var(--surface2);}
.cl-game-title{font-size:13px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:.06em;}
.cl-game-prog{font-size:13px;font-weight:900;color:var(--muted);}
.cl-game-canvas{padding:12px 18px 16px;background:#fff;text-align:center;min-height:130px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;}
canvas#gameCanvas{border-radius:10px;max-width:100%;}

/* Checklist items */
.cl-list{display:flex;flex-direction:column;gap:8px;}
.cl-item{display:flex;align-items:flex-start;gap:14px;padding:14px 16px;border-radius:12px;border:2px solid var(--border);background:var(--surface);cursor:pointer;transition:all .2s;user-select:none;}
.cl-item:hover{border-color:#aaa;box-shadow:0 2px 8px rgba(0,0,0,.07);}
.cl-item.done{opacity:.65;}
.cl-item.done .cl-item-txt{text-decoration:line-through;color:var(--muted);}
.cl-checkbox{width:26px;height:26px;border-radius:8px;border:2.5px solid var(--border);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:900;transition:all .2s;margin-top:1px;}
.cl-item.done .cl-checkbox{background:var(--l2);border-color:var(--l2);color:#fff;}
.cl-item-body{flex:1;}
.cl-item-txt{font-size:16px;font-weight:700;color:var(--text);line-height:1.55;}
.cl-item-hint{font-size:13px;font-weight:700;color:var(--muted);margin-top:3px;font-style:italic;}

/* Progress bar */
.cl-progress-wrap{background:var(--surface2);border-radius:10px;padding:12px 16px;display:flex;align-items:center;gap:14px;}
.cl-progress-label{font-size:13px;font-weight:900;color:var(--text);flex-shrink:0;}
.cl-progress-bar{flex:1;height:12px;background:var(--border);border-radius:6px;overflow:hidden;}
.cl-progress-fill{height:100%;border-radius:6px;transition:width .4s cubic-bezier(.34,1.56,.64,1);background:var(--l2);}
.cl-progress-pct{font-size:13px;font-weight:900;color:var(--muted);flex-shrink:0;min-width:36px;text-align:right;}

/* Confetti burst (JS-driven) */
.confetti-piece{position:fixed;border-radius:3px;pointer-events:none;z-index:9999;animation:confettiFall 1.2s ease-in forwards;}
@keyframes confettiFall{0%{opacity:1;transform:translateY(0) rotate(0deg);}100%{opacity:0;transform:translateY(300px) rotate(720deg);}}

/* Reset btn */
.cl-reset{margin-top:8px;padding:9px 20px;border-radius:50px;border:2px solid var(--border);background:var(--bg);font-size:13px;font-weight:900;color:var(--muted);cursor:pointer;font-family:'Nunito',sans-serif;transition:all .15s;align-self:center;}
.cl-reset:hover{border-color:#888;color:var(--text);}


/* ═══════════════════════════════════════
   LEARN DESIGN TAB
═══════════════════════════════════════ */

/* Top-level mode switcher */
.mode-bar{background:var(--surface);border-bottom:3px solid var(--border);display:flex;gap:0;padding:0 36px;}
.mode-tab{padding:14px 24px;border:none;background:transparent;cursor:pointer;font-family:'Nunito',sans-serif;font-size:15px;font-weight:800;color:var(--muted);border-bottom:4px solid transparent;margin-bottom:-3px;transition:all .15s;display:flex;align-items:center;gap:8px;}
.mode-tab:hover{color:var(--text);}
.mode-tab.on{color:var(--text);border-bottom-color:var(--l4);}

/* Hide/show main panels */
.panel{display:none;}
.panel.on{display:block;}
.panel-flex{display:none;}
.panel-flex.on{display:flex;}

/* ── LEARN LAYOUT ── */
.learn-layout{display:grid;grid-template-columns:260px 1fr;min-height:calc(100vh - 122px);}
.learn-nav{background:var(--surface);border-right:3px solid var(--border);padding:22px 16px;display:flex;flex-direction:column;gap:6px;position:sticky;top:0;height:calc(100vh - 122px);overflow-y:auto;}
.learn-nav::-webkit-scrollbar{width:4px;} .learn-nav::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}
.learn-nav-section{font-size:10px;font-weight:900;letter-spacing:.14em;text-transform:uppercase;color:var(--dim);padding:14px 12px 6px;margin-top:4px;}
.learn-nav-section:first-child{margin-top:0;}
.learn-nav-btn{display:flex;align-items:center;gap:10px;padding:10px 13px;border-radius:12px;border:2px solid transparent;background:transparent;cursor:pointer;width:100%;text-align:left;font-family:'Nunito',sans-serif;font-size:14px;font-weight:700;color:var(--muted);transition:all .15s;}
.learn-nav-btn:hover{background:var(--bg);color:var(--text);}
.learn-nav-btn.on{background:var(--l4-bg);border-color:var(--l4-bd);color:var(--l4);font-weight:900;}
.learn-nav-icon{font-size:18px;flex-shrink:0;}

/* ── LEARN CONTENT ── */
.learn-content{padding:36px 44px;max-width:860px;}
.learn-section{display:none;}
.learn-section.on{display:block;}

/* Article header */
.learn-art-hdr{margin-bottom:28px;padding-bottom:20px;border-bottom:3px solid var(--border);}
.learn-art-badge{display:inline-flex;align-items:center;gap:6px;padding:5px 14px;border-radius:50px;font-size:12px;font-weight:900;border:2px solid;margin-bottom:10px;background:var(--l4-bg);color:var(--l4);border-color:var(--l4-bd);}
.learn-art-title{font-size:30px;font-weight:900;color:var(--text);line-height:1.2;margin-bottom:8px;}
.learn-art-sub{font-size:16px;font-weight:700;color:var(--muted);line-height:1.6;}

/* Cards grid */
.learn-cards{display:grid;gap:16px;margin:24px 0;}
.learn-cards.cols2{grid-template-columns:1fr 1fr;}
.learn-cards.cols3{grid-template-columns:1fr 1fr 1fr;}
.learn-card{border-radius:16px;border:2.5px solid var(--border);padding:20px;background:var(--surface);transition:box-shadow .15s,transform .15s;}
.learn-card:hover{box-shadow:0 4px 18px rgba(0,0,0,.1);transform:translateY(-2px);}
.learn-card-icon{font-size:28px;margin-bottom:10px;}
.learn-card-title{font-size:16px;font-weight:900;color:var(--text);margin-bottom:6px;}
.learn-card-body{font-size:14px;font-weight:700;color:var(--muted);line-height:1.65;}
/* Colour variants */
.learn-card.ca{border-color:var(--ca);background:var(--ca-bg);}
.learn-card.cb{border-color:var(--cb);background:var(--cb-bg);}
.learn-card.cc{border-color:var(--cc);background:var(--cc-bg);}
.learn-card.cd{border-color:var(--cd);background:var(--cd-bg);}
.learn-card.lv1{border-color:var(--l1-bd);background:var(--l1-bg);}
.learn-card.lv2{border-color:var(--l2-bd);background:var(--l2-bg);}
.learn-card.lv3{border-color:var(--l3-bd);background:var(--l3-bg);}
.learn-card.lv4{border-color:var(--l4-bd);background:var(--l4-bg);}

/* Prose */
.learn-prose{font-size:16px;font-weight:700;color:var(--text);line-height:1.8;margin-bottom:20px;}
.learn-prose strong{font-weight:900;}
.learn-h2{font-size:20px;font-weight:900;color:var(--text);margin:28px 0 12px;display:flex;align-items:center;gap:10px;}
.learn-h3{font-size:17px;font-weight:900;color:var(--text);margin:20px 0 8px;}

/* Callout boxes */
.learn-callout{border-radius:14px;padding:18px 20px;border-left:5px solid;margin:20px 0;}
.learn-callout.tip{background:#f0eaff;border-color:var(--l4);} .learn-callout.tip .lc-lbl{color:var(--l4);}
.learn-callout.warn{background:#fffbea;border-color:#f0c040;} .learn-callout.warn .lc-lbl{color:#7a5a00;}
.learn-callout.good{background:#e2f7ec;border-color:var(--l2);} .learn-callout.good .lc-lbl{color:var(--l2);}
.learn-callout.bad{background:#fde8f0;border-color:var(--l1);} .learn-callout.bad .lc-lbl{color:var(--l1);}
.lc-lbl{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;margin-bottom:6px;}
.lc-txt{font-size:15px;font-weight:700;color:var(--text);line-height:1.65;}

/* Design cycle SVG ring */
.dc-ring-wrap{display:flex;justify-content:center;margin:24px 0;}

/* ACCESSFM table */
.accessfm-table{width:100%;border-collapse:collapse;border-radius:14px;overflow:hidden;border:2.5px solid var(--border);margin:20px 0;}
.accessfm-table th,.accessfm-table td{padding:14px 18px;text-align:left;border-bottom:2px solid var(--border);font-size:15px;}
.accessfm-table th{font-size:12px;font-weight:900;text-transform:uppercase;letter-spacing:.08em;background:var(--surface2);}
.accessfm-table tr:last-child td{border-bottom:none;}
.accessfm-table tr:hover td{background:var(--bg);}
.af-letter{font-size:22px;font-weight:900;width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;color:#fff;flex-shrink:0;}

/* Cite example box */
.cite-box{background:var(--surface2);border-radius:12px;padding:16px 18px;border:2px solid var(--border);font-size:14px;font-weight:700;color:var(--text);line-height:1.8;margin:10px 0;font-family:monospace;}
.cite-label{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);margin-bottom:6px;}

/* AI accordion */
.ai-crit{border:2.5px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:12px;}
.ai-crit-hdr{display:flex;align-items:center;gap:12px;padding:14px 18px;cursor:pointer;background:var(--surface);transition:background .15s;user-select:none;}
.ai-crit-hdr:hover{background:var(--bg);}
.ai-crit-hdr.open{background:var(--surface2);}
.ai-crit-badge{width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:900;flex-shrink:0;}
.ai-crit-name{font-size:16px;font-weight:900;color:var(--text);flex:1;}
.ai-crit-arrow{font-size:14px;color:var(--dim);transition:transform .2s;}
.ai-crit-hdr.open .ai-crit-arrow{transform:rotate(90deg);}
.ai-crit-body{display:none;padding:0 18px 18px;}
.ai-crit-hdr.open + .ai-crit-body{display:block;}
.ai-strand{border-radius:12px;padding:14px 16px;margin-top:12px;border:2px solid;}
.ai-strand-title{font-size:14px;font-weight:900;margin-bottom:10px;}
.ai-do{border-radius:8px;padding:10px 13px;margin:6px 0;font-size:14px;font-weight:700;line-height:1.6;}
.ai-do.yes{background:#e2f7ec;border-left:4px solid var(--l2);color:var(--text);}
.ai-do.no{background:#fde8f0;border-left:4px solid var(--l1);color:var(--text);}
.ai-prompt-box{background:#f0eaff;border-radius:10px;padding:12px 14px;border:2px solid var(--l4-bd);margin-top:10px;}
.ai-prompt-lbl{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--l4);margin-bottom:5px;}
.ai-prompt{font-size:14px;font-weight:700;color:#2a0060;line-height:1.6;font-style:italic;}

/* Design principles list */
.dp-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin:20px 0;}
.dp-card{border-radius:14px;padding:18px;border:2.5px solid var(--border);background:var(--surface);}
.dp-num{font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);margin-bottom:4px;}
.dp-name{font-size:17px;font-weight:900;color:var(--text);margin-bottom:6px;}
.dp-body{font-size:14px;font-weight:700;color:var(--muted);line-height:1.6;}
.dp-example{font-size:13px;font-weight:700;font-style:italic;color:var(--text);background:var(--bg);border-radius:8px;padding:8px 12px;margin-top:8px;}

@media(max-width:860px){
  .learn-layout{grid-template-columns:1fr;}
  .learn-nav{position:static;height:auto;border-right:none;border-bottom:3px solid var(--border);}
  .learn-content{padding:20px;}
  .learn-cards.cols2,.learn-cards.cols3,.dp-grid{grid-template-columns:1fr;}
  .mode-bar{padding:0 16px;}
}

</style>
</head>
<body>

<div class="tip" id="tip">
  <div class="tip-head" id="tipHead">
    <div class="tip-word" id="tipWord"></div>
    <div class="tip-lvl" id="tipLvl"></div>
  </div>
  <div class="tip-body">
    <div class="tip-simple" id="tipSimple"></div>
    <div class="tip-ex-label">Example at this level:</div>
    <div class="tip-ex" id="tipEx"></div>
  </div>
</div>


<!-- Checklist modal -->
<div class="modal-bg" id="clBg">
  <div class="modal cl-modal">
    <div class="modal-hdr">
      <div>
        <div class="modal-title">&#9989; My Challenge Checklist</div>
        <div class="modal-sub" id="clModalSub">Set your goal and choose your game!</div>
      </div>
      <button class="close-x" id="clClose">X</button>
    </div>
    <div class="modal-body">

      <!-- Step 1: Choose criterion -->
      <div class="cl-step active" id="clStep1">
        <div class="cl-step-hdr">
          <div class="cl-step-num">Step 1 of 4</div>
          <div class="cl-step-title">Which Criterion are you working on?</div>
          <div class="cl-step-sub">Pick the one your teacher has assigned.</div>
        </div>
        <div class="cl-choices cols2" id="clCritChoices">
          <div class="cl-choice" data-val="A"><div class="cl-choice-icon">&#128269;</div><div class="cl-choice-name">Criterion A</div><div class="cl-choice-sub">Inquiring &amp; Analyzing</div></div>
          <div class="cl-choice" data-val="B"><div class="cl-choice-icon">&#128161;</div><div class="cl-choice-name">Criterion B</div><div class="cl-choice-sub">Developing Ideas</div></div>
          <div class="cl-choice" data-val="C"><div class="cl-choice-icon">&#128736;</div><div class="cl-choice-name">Criterion C</div><div class="cl-choice-sub">Creating the Solution</div></div>
          <div class="cl-choice" data-val="D"><div class="cl-choice-icon">&#128203;</div><div class="cl-choice-name">Criterion D</div><div class="cl-choice-sub">Evaluating</div></div>
        </div>
        <div class="cl-nav">
          <div></div>
          <div class="cl-dots"><div class="cl-dot on"></div><div class="cl-dot"></div><div class="cl-dot"></div><div class="cl-dot"></div></div>
          <button class="cl-nav-next" id="clNext1" disabled onclick="clGoStep(2)">Next &#8594;</button>
        </div>
      </div>

      <!-- Step 2: Choose strand -->
      <div class="cl-step" id="clStep2">
        <div class="cl-step-hdr">
          <div class="cl-step-num">Step 2 of 4</div>
          <div class="cl-step-title">Which Strand are you focusing on?</div>
          <div class="cl-step-sub">Pick the specific skill area for this task.</div>
        </div>
        <div class="cl-choices" id="clStrandChoices" style="grid-template-columns:1fr 1fr;"></div>
        <div class="cl-nav">
          <button class="cl-nav-back" onclick="clGoStep(1)">&#8592; Back</button>
          <div class="cl-dots"><div class="cl-dot"></div><div class="cl-dot on"></div><div class="cl-dot"></div><div class="cl-dot"></div></div>
          <button class="cl-nav-next" id="clNext2" disabled onclick="clGoStep(3)">Next &#8594;</button>
        </div>
      </div>

      <!-- Step 3: Choose level + grade -->
      <div class="cl-step" id="clStep3">
        <div class="cl-step-hdr">
          <div class="cl-step-num">Step 3 of 4</div>
          <div class="cl-step-title">What level are you aiming for?</div>
          <div class="cl-step-sub">Challenge yourself! Higher levels need more depth and evidence.</div>
        </div>
        <div class="cl-choices cols4" id="clLvlChoices">
          <div class="cl-choice" data-val="1" data-lv="1"><div class="cl-choice-icon">&#128543;</div><div class="cl-choice-name">1-2</div><div class="cl-choice-sub">Not Yet There</div></div>
          <div class="cl-choice" data-val="2" data-lv="2"><div class="cl-choice-icon">&#128077;</div><div class="cl-choice-name">3-4</div><div class="cl-choice-sub">Meeting</div></div>
          <div class="cl-choice" data-val="3" data-lv="3"><div class="cl-choice-icon">&#128640;</div><div class="cl-choice-name">5-6</div><div class="cl-choice-sub">Exceeding</div></div>
          <div class="cl-choice" data-val="4" data-lv="4"><div class="cl-choice-icon">&#127942;</div><div class="cl-choice-name">7-8</div><div class="cl-choice-sub">Excelling</div></div>
        </div>
        <div style="margin-top:18px;">
          <div class="prog-sel-label" style="margin-bottom:8px;">Your grade level:</div>
          <select class="prog-sel" id="clGrade" style="max-width:280px;">
            <option value="MYP1">MYP 1 - Grade 6</option>
            <option value="MYP3">MYP 3 - Grades 7 and 8</option>
            <option value="MYP5" selected>MYP 5 - Grades 9 and 10</option>
          </select>
        </div>
        <div class="cl-nav">
          <button class="cl-nav-back" onclick="clGoStep(2)">&#8592; Back</button>
          <div class="cl-dots"><div class="cl-dot"></div><div class="cl-dot"></div><div class="cl-dot on"></div><div class="cl-dot"></div></div>
          <button class="cl-nav-next" id="clNext3" disabled onclick="clGoStep(4)">Next &#8594;</button>
        </div>
      </div>

      <!-- Step 4: Choose game -->
      <div class="cl-step" id="clStep4">
        <div class="cl-step-hdr">
          <div class="cl-step-num">Step 4 of 4</div>
          <div class="cl-step-title">Pick your reward game!</div>
          <div class="cl-step-sub">Every time you tick a task, your game will progress!</div>
        </div>
        <div class="cl-choices" style="grid-template-columns:1fr 1fr 1fr;" id="clGameChoices">
          <div class="cl-choice" data-val="plant"><div class="cl-choice-icon">&#127807;</div><div class="cl-choice-name">Grow a Plant</div><div class="cl-choice-sub">Tick tasks to grow from seed to flower!</div></div>
          <div class="cl-choice" data-val="f1"><div class="cl-choice-icon">&#127947;</div><div class="cl-choice-name">F1 Race</div><div class="cl-choice-sub">Tick tasks to speed your car to the finish!</div></div>
          <div class="cl-choice" data-val="animal"><div class="cl-choice-icon">&#128062;</div><div class="cl-choice-name">Rescue Animal</div><div class="cl-choice-sub">Tick tasks to nurse an animal back to health!</div></div>
        </div>
        <div class="cl-nav">
          <button class="cl-nav-back" onclick="clGoStep(3)">&#8592; Back</button>
          <div class="cl-dots"><div class="cl-dot"></div><div class="cl-dot"></div><div class="cl-dot"></div><div class="cl-dot on"></div></div>
          <button class="cl-nav-next" id="clNext4" disabled onclick="clGenerate()">Generate my Checklist! &#127775;</button>
        </div>
      </div>

      <!-- Step 5: The actual checklist -->
      <div class="cl-step" id="clStep5">
        <div class="cl-output" id="clOutput"></div>
        <div style="display:flex;justify-content:space-between;align-items:center;padding-top:20px;border-top:2px solid var(--border);margin-top:8px;">
          <button class="cl-reset" onclick="clGoStep(1)">&#8592; Start Over</button>
          <button class="cl-nav-next" onclick="clPrint()" style="background:var(--muted);">&#128438; Print / Save</button>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Compare modal -->
<div class="modal-bg" id="cmpBg">
  <div class="modal">
    <div class="modal-hdr">
      <div>
        <div class="modal-title">Compare Command Terms</div>
        <div class="modal-sub">Pick two words and see exactly how they are different!</div>
      </div>
      <button class="close-x" id="cmpClose">X</button>
    </div>
    <div class="modal-body">
      <div class="sel-row">
        <select class="tsel" id="sel1"></select>
        <div class="vs">VS</div>
        <select class="tsel" id="sel2"></select>
      </div>
      <div class="cmp-result" id="cmpResult"></div>
    </div>
  </div>
</div>

<!-- Progression modal -->
<div class="modal-bg" id="progBg">
  <div class="modal prog-modal">
    <div class="modal-hdr">
      <div>
        <div class="modal-title">See the Progression</div>
        <div class="modal-sub">Watch how the expectation grows from Level 1-2 all the way to 7-8.</div>
      </div>
      <button class="close-x" id="progClose">X</button>
    </div>
    <div class="modal-body">
      <div class="prog-selectors">
        <div class="prog-sel-wrap">
          <div class="prog-sel-label">Criterion</div>
          <select class="prog-sel" id="progCrit"></select>
        </div>
        <div class="prog-sel-wrap">
          <div class="prog-sel-label">Strand</div>
          <select class="prog-sel" id="progStrand"></select>
        </div>
        <div class="prog-sel-wrap">
          <div class="prog-sel-label">Grade Level</div>
          <select class="prog-sel" id="progGrade">
            <option value="MYP1">MYP 1 - Grade 6</option>
            <option value="MYP3">MYP 3 - Grades 7 and 8</option>
            <option value="MYP5" selected>MYP 5 - Grades 9 and 10</option>
          </select>
        </div>
      </div>
      <div id="progTrack"></div>
    </div>
  </div>
</div>

<header>
  <div class="hdr-left">
    <div class="hdr-icon">&#128208;</div>
    <div>
      <div class="hdr-title">MYP Design Rubric Explorer</div>
      <div class="hdr-sub">Hover the coloured words to learn what they mean!</div>
    </div>
  </div>
  <div class="hdr-btns">
    <button class="check-btn" id="check-btn-hdr">&#9989; My Checklist</button>
    <button class="prog-btn" id="progBtn">&#128200; See the Progression</button>
    <button class="diff-btn" id="diffBtn">&#128260; Compare Command Terms</button>
  </div>
</header>

<!-- Mode bar -->
<div class="mode-bar">
  <button class="mode-tab on" id="modeRubric">&#128209; Rubric Explorer</button>
  <button class="mode-tab" id="modeLearn">&#127979; Learn Design</button>
</div>

<!-- RUBRIC PANEL -->
<div class="panel-flex on" id="panelRubric" style="flex-direction:row;">
<div class="layout" style="width:100%;display:contents;">
  <aside class="sidebar">
    <div>
      <div class="flabel">Criterion</div>
      <button class="crit-btn on" data-c="A"><span class="cswatch"></span><div><div class="clabel">Criterion A</div><div class="csub">Inquiring &amp; Analyzing</div></div></button>
      <button class="crit-btn" data-c="B"><span class="cswatch"></span><div><div class="clabel">Criterion B</div><div class="csub">Developing Ideas</div></div></button>
      <button class="crit-btn" data-c="C"><span class="cswatch"></span><div><div class="clabel">Criterion C</div><div class="csub">Creating the Solution</div></div></button>
      <button class="crit-btn" data-c="D"><span class="cswatch"></span><div><div class="clabel">Criterion D</div><div class="csub">Evaluating</div></div></button>
    </div>
    <div><div class="flabel">Strand</div><div id="strandBtns"></div></div>
    <div>
      <div class="flabel">Grade Level</div>
      <button class="grade-btn on" data-g="MYP1"><span class="tbox">v</span>MYP 1 - Grade 6</button>
      <button class="grade-btn on" data-g="MYP3"><span class="tbox">v</span>MYP 3 - Grades 7 and 8</button>
      <button class="grade-btn on" data-g="MYP5"><span class="tbox">v</span>MYP 5 - Grades 9 and 10</button>
    </div>
    <div>
      <div class="flabel">Achievement Level</div>
      <div class="lvl-pills">
        <button class="lvl-pill on" data-lv="1">1-2 Not Yet There</button>
        <button class="lvl-pill on" data-lv="2">3-4 Meeting</button>
        <button class="lvl-pill on" data-lv="3">5-6 Exceeding</button>
        <button class="lvl-pill on" data-lv="4">7-8 Excelling</button>
      </div>
    </div>
    <div>
      <div class="flabel">View</div>
      <div class="vtoggle">
        <button class="vbtn on" data-v="grid">Grid</button>
        <button class="vbtn" data-v="table">Table</button>
        <button class="vbtn" data-v="compare">Compare</button>
      </div>
    </div>
  </aside>
  <main class="main" id="mainArea"></main>
</div>
</div><!-- /panelRubric -->

<!-- LEARN DESIGN PANEL -->
<div class="panel on" id="panelLearn" style="display:none;">
<div class="learn-layout">

  <!-- LEFT NAV -->
  <nav class="learn-nav">
    <div class="learn-nav-section">Foundations</div>
    <button class="learn-nav-btn on" data-sec="design-cycle"><span class="learn-nav-icon">&#9851;</span>The Design Cycle</button>
    <button class="learn-nav-btn" data-sec="design-principles"><span class="learn-nav-icon">&#127775;</span>Design Principles</button>
    <button class="learn-nav-btn" data-sec="accessfm"><span class="learn-nav-icon">&#128269;</span>ACCESS FM</button>
    <div class="learn-nav-section">Research Skills</div>
    <button class="learn-nav-btn" data-sec="primary-secondary"><span class="learn-nav-icon">&#128202;</span>Primary vs Secondary Research</button>
    <button class="learn-nav-btn" data-sec="citing"><span class="learn-nav-icon">&#128218;</span>How to Cite Sources</button>
    <button class="learn-nav-btn" data-sec="specifications"><span class="learn-nav-icon">&#9989;</span>Writing Specifications</button>
    <div class="learn-nav-section">Design Skills</div>
    <button class="learn-nav-btn" data-sec="drawing"><span class="learn-nav-icon">&#9999;</span>Design Drawing Types</button>
    <button class="learn-nav-btn" data-sec="materials"><span class="learn-nav-icon">&#129520;</span>Materials & Properties</button>
    <button class="learn-nav-btn" data-sec="testing"><span class="learn-nav-icon">&#128300;</span>Product Testing Methods</button>
    <div class="learn-nav-section">Using AI Wisely</div>
    <button class="learn-nav-btn" data-sec="ai-integrity"><span class="learn-nav-icon">&#129302;</span>AI & Academic Integrity</button>
    <button class="learn-nav-btn" data-sec="ai-criteria"><span class="learn-nav-icon">&#127919;</span>AI for Each Criterion</button>
  </nav>

  <!-- CONTENT AREA -->
  <div class="learn-content">

    <!-- ══ DESIGN CYCLE ══ -->
    <div class="learn-section on" id="sec-design-cycle">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#9851; Foundations</div>
        <div class="learn-art-title">The MYP Design Cycle</div>
        <div class="learn-art-sub">The Design Cycle is the four-step process every MYP Design student follows to solve real problems — it is not just a sequence, it is a way of thinking.</div>
      </div>

      <!-- SVG cycle diagram -->
      <div class="dc-ring-wrap">
        <svg viewBox="0 0 420 300" width="420" height="300" font-family="Nunito,sans-serif">
          <!-- Central circle -->
          <circle cx="210" cy="150" r="48" fill="#f0eaff" stroke="#b898f2" stroke-width="3"/>
          <text x="210" y="144" text-anchor="middle" font-size="13" font-weight="900" fill="#4a18a8">Design</text>
          <text x="210" y="160" text-anchor="middle" font-size="13" font-weight="900" fill="#4a18a8">Cycle</text>

          <!-- A - Inquiring (top) -->
          <circle cx="210" cy="46" r="42" fill="#e4f5fb" stroke="#29a8d4" stroke-width="3"/>
          <text x="210" y="40" text-anchor="middle" font-size="13" font-weight="900" fill="#0e5878">Criterion A</text>
          <text x="210" y="56" text-anchor="middle" font-size="11" font-weight="800" fill="#29a8d4">Inquiring &amp;</text>
          <text x="210" y="68" text-anchor="middle" font-size="11" font-weight="800" fill="#29a8d4">Analyzing</text>

          <!-- B - Developing (right) -->
          <circle cx="366" cy="150" r="42" fill="#fef3c7" stroke="#d49800" stroke-width="3"/>
          <text x="366" y="144" text-anchor="middle" font-size="13" font-weight="900" fill="#7a5000">Criterion B</text>
          <text x="366" y="160" text-anchor="middle" font-size="11" font-weight="800" fill="#d49800">Developing</text>
          <text x="366" y="172" text-anchor="middle" font-size="11" font-weight="800" fill="#d49800">Ideas</text>

          <!-- C - Creating (bottom) -->
          <circle cx="210" cy="254" r="42" fill="#e2f7ec" stroke="#28a85e" stroke-width="3"/>
          <text x="210" y="248" text-anchor="middle" font-size="13" font-weight="900" fill="#146832">Criterion C</text>
          <text x="210" y="264" text-anchor="middle" font-size="11" font-weight="800" fill="#28a85e">Creating the</text>
          <text x="210" y="276" text-anchor="middle" font-size="11" font-weight="800" fill="#28a85e">Solution</text>

          <!-- D - Evaluating (left) -->
          <circle cx="54" cy="150" r="42" fill="#fdeaea" stroke="#e03c3c" stroke-width="3"/>
          <text x="54" y="144" text-anchor="middle" font-size="13" font-weight="900" fill="#7a1010">Criterion D</text>
          <text x="54" y="160" text-anchor="middle" font-size="11" font-weight="800" fill="#e03c3c">Evaluating</text>

          <!-- Arrows between them (curved arcs) -->
          <defs>
            <marker id="arr" markerWidth="8" markerHeight="8" refX="4" refY="4" orient="auto">
              <path d="M0,0 L8,4 L0,8 Z" fill="#999"/>
            </marker>
          </defs>
          <!-- A→B -->
          <path d="M248,74 Q310,74 326,110" fill="none" stroke="#bbb" stroke-width="2.5" marker-end="url(#arr)"/>
          <!-- B→C -->
          <path d="M340,188 Q340,240 256,252" fill="none" stroke="#bbb" stroke-width="2.5" marker-end="url(#arr)"/>
          <!-- C→D -->
          <path d="M170,268 Q110,268 82,210" fill="none" stroke="#bbb" stroke-width="2.5" marker-end="url(#arr)"/>
          <!-- D→A -->
          <path d="M76,110 Q100,58 170,56" fill="none" stroke="#bbb" stroke-width="2.5" marker-end="url(#arr)"/>
        </svg>
      </div>

      <div class="learn-cards cols2">
        <div class="learn-card ca">
          <div class="learn-card-icon">&#128269;</div>
          <div class="learn-card-title">Criterion A — Inquiring &amp; Analyzing</div>
          <div class="learn-card-body">You research the problem deeply. Who has the problem? Why does it exist? What already exists that tries to solve it? You build a design brief that justifies why your solution is needed.</div>
        </div>
        <div class="learn-card cb">
          <div class="learn-card-icon">&#128161;</div>
          <div class="learn-card-title">Criterion B — Developing Ideas</div>
          <div class="learn-card-body">You create a detailed specification of what your solution must do, then design multiple possible solutions. You choose the best one and justify why — always referring back to your specification.</div>
        </div>
        <div class="learn-card cc">
          <div class="learn-card-icon">&#128736;</div>
          <div class="learn-card-title">Criterion C — Creating the Solution</div>
          <div class="learn-card-body">You plan your making process, then build your solution using the correct techniques. You document changes you make along the way and why you made them.</div>
        </div>
        <div class="learn-card cd">
          <div class="learn-card-icon">&#128203;</div>
          <div class="learn-card-title">Criterion D — Evaluating</div>
          <div class="learn-card-body">You test your finished solution against your specification using real data. You evaluate honestly — both successes and failures — and explain how it could be improved and what impact it has.</div>
        </div>
      </div>

      <div class="learn-callout tip">
        <div class="lc-lbl">&#128161; Key Idea</div>
        <div class="lc-txt">The cycle does <strong>not</strong> have to go in a straight line. Real designers go backwards — you might discover during <strong>making</strong> that your <strong>specification</strong> needs updating, or during <strong>testing</strong> that you need to <strong>redesign</strong> part of your solution. That's not failure — that's good design thinking!</div>
      </div>
    </div>

    <!-- ══ DESIGN PRINCIPLES ══ -->
    <div class="learn-section" id="sec-design-principles">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#127775; Foundations</div>
        <div class="learn-art-title">Design Principles</div>
        <div class="learn-art-sub">Great design isn't accidental. These core principles guide designers to create products that are not only beautiful but functional, sustainable, and user-centred.</div>
      </div>

      <div class="dp-grid">
        <div class="dp-card"><div class="dp-num">Principle 01</div><div class="dp-name">&#129505; Form follows Function</div><div class="dp-body">A product's shape should be driven by what it needs to DO, not just how it looks. Beauty comes from a design that works perfectly.</div><div class="dp-example">A hammer has a heavy metal head and a long grip — not because it looks good, but because that shape delivers the most force.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 02</div><div class="dp-name">&#128106; User-Centred Design</div><div class="dp-body">Design for the real human who will use it. Understand their needs, abilities, and limitations before deciding what your product looks or works like.</div><div class="dp-example">A water bottle designed for elderly users has a wider grip and a no-squeeze lid because small hands and reduced strength were considered first.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 03</div><div class="dp-name">&#9854; Ergonomics</div><div class="dp-body">Products must fit the human body comfortably and safely. Ergonomics considers size, reach, strength, and comfort so people can use products without injury or strain.</div><div class="dp-example">A keyboard with a slight upward curve reduces wrist strain — designed around how human wrists naturally rest.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 04</div><div class="dp-name">&#9855; Universal Design</div><div class="dp-body">Design so that as many people as possible can use it — regardless of age, ability, or disability. Good universal design benefits everyone, not just those with special needs.</div><div class="dp-example">Kerb cuts in pavements were designed for wheelchair users but are used constantly by cyclists, parents with prams, and delivery workers.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 05</div><div class="dp-name">&#127807; Sustainability</div><div class="dp-body">Design with the full lifecycle in mind: where do the materials come from? How much energy does making it use? What happens when it breaks or is no longer needed?</div><div class="dp-example">A modular product where only broken parts are replaced instead of the whole product reduces waste dramatically.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 06</div><div class="dp-name">&#128396; Less is More (Minimalism)</div><div class="dp-body">Remove everything that isn't necessary. Simpler products are usually easier to use, cheaper to make, and more reliable. Every feature should earn its place.</div><div class="dp-example">The original iPod had one button and a scroll wheel — most music players at the time had 30+ buttons. Apple's simplicity won.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 07</div><div class="dp-name">&#9993; Clear Communication</div><div class="dp-body">A product should communicate how it works without instructions. Buttons should look pressable, handles should invite gripping, and colours should signal function.</div><div class="dp-example">A red button on a machine signals danger/stop. A green button signals start/safe. This is colour language that users already know.</div></div>
        <div class="dp-card"><div class="dp-num">Principle 08</div><div class="dp-name">&#128504; Iteration</div><div class="dp-body">No design is perfect on the first try. Great designers prototype, test, get feedback, and improve — repeatedly. Each version is better than the last.</div><div class="dp-example">Dyson built over 5,000 prototypes of his vacuum cleaner before reaching the final version that worked perfectly.</div></div>
      </div>

      <div class="learn-callout good">
        <div class="lc-lbl">&#9989; Apply This in Your Assessment</div>
        <div class="lc-txt">When you analyse existing products in <strong>Criterion A</strong> or justify your design choices in <strong>Criterion B</strong>, use these principles by name. Saying "this product demonstrates good ergonomics because..." shows much deeper thinking than just "it looks comfortable."</div>
      </div>
    </div>

    <!-- ══ ACCESS FM ══ -->
    <div class="learn-section" id="sec-accessfm">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#128269; Foundations</div>
        <div class="learn-art-title">ACCESS FM</div>
        <div class="learn-art-sub">ACCESS FM is a framework for analysing existing products. It gives you a structured way to evaluate ANY product from multiple angles — and is especially powerful in Criterion A Strand 3.</div>
      </div>
      <div class="learn-callout tip">
        <div class="lc-lbl">&#128161; What is ACCESS FM?</div>
        <div class="lc-txt">ACCESS FM stands for <strong>Aesthetics, Cost, Customer, Environment, Safety, Size, Function, and Materials</strong>. Using all 8 headings ensures you analyse a product deeply — not just its appearance or its purpose, but all the factors that make it succeed or fail.</div>
      </div>
      <table class="accessfm-table">
        <thead><tr><th>Letter</th><th>Stands for</th><th>What to consider</th><th>Example question</th></tr></thead>
        <tbody>
          <tr><td><span class="af-letter" style="background:#e91e63">A</span></td><td><strong>Aesthetics</strong></td><td>How it looks, sounds, smells, feels. Colour, texture, finish, shape, style.</td><td>Does the colour choice attract the target audience? Does the shape feel premium?</td></tr>
          <tr><td><span class="af-letter" style="background:#9c27b0">C</span></td><td><strong>Cost</strong></td><td>Purchase price, manufacturing cost, running costs, value for money.</td><td>Is it affordable for the target audience? Is it worth what it costs?</td></tr>
          <tr><td><span class="af-letter" style="background:#2196f3">C</span></td><td><strong>Customer</strong></td><td>Who is it designed for? Age, gender, lifestyle, ability, income.</td><td>Does the design suit the actual person who will use it?</td></tr>
          <tr><td><span class="af-letter" style="background:#4caf50">E</span></td><td><strong>Environment</strong></td><td>Sustainability, recyclability, impact during manufacture and disposal, carbon footprint.</td><td>Where do the materials come from? Can it be recycled at end of life?</td></tr>
          <tr><td><span class="af-letter" style="background:#ff5722">S</span></td><td><strong>Safety</strong></td><td>Risk of injury in use, safety standards met, age-appropriate safety features.</td><td>Are there sharp edges? Does it meet safety regulations for this age group?</td></tr>
          <tr><td><span class="af-letter" style="background:#607d8b">S</span></td><td><strong>Size</strong></td><td>Dimensions, weight, portability, ergonomic fit for the user.</td><td>Is it the right size for the target user's hands? Does it fit in a school bag?</td></tr>
          <tr><td><span class="af-letter" style="background:#ff9800">F</span></td><td><strong>Function</strong></td><td>What it does, how well it works, reliability, ease of use.</td><td>Does it do what it claims? Is it easy to use without instructions?</td></tr>
          <tr><td><span class="af-letter" style="background:#795548">M</span></td><td><strong>Materials</strong></td><td>What it is made from, properties of those materials, why those materials were chosen.</td><td>Why was plastic used instead of metal? Is the material appropriate for its purpose?</td></tr>
        </tbody>
      </table>
      <div class="learn-callout good">
        <div class="lc-lbl">&#128203; How to Use ACCESS FM in an Assessment</div>
        <div class="lc-txt">Don't just list facts. For each letter, <strong>evaluate</strong>: say what you found AND what that means for your own design. Example: "The existing product uses ABS plastic (Materials) — this is lightweight and mouldable, which suits a portable product. However it is not recyclable, which is a weakness I will address by using recycled HDPE in my design." That is analysis, not just description.</div>
      </div>
    </div>

    <!-- ══ PRIMARY vs SECONDARY ══ -->
    <div class="learn-section" id="sec-primary-secondary">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#128202; Research Skills</div>
        <div class="learn-art-title">Primary vs Secondary Research</div>
        <div class="learn-art-sub">Understanding the difference between primary and secondary research is essential for Criterion A. Both types have strengths and weaknesses — and strong students use both.</div>
      </div>
      <div class="learn-cards cols2">
        <div class="learn-card lv3">
          <div class="learn-card-icon">&#128100;</div>
          <div class="learn-card-title">Primary Research</div>
          <div class="learn-card-body">Research you collect yourself, directly from people or the real world. It is specific to your exact question and your exact client.<br><br><strong>Examples:</strong> Surveys, interviews, observations, experiments, product testing, focus groups.<br><br><strong>Strength:</strong> Directly relevant to your design problem. No one else has this data.<br><strong>Weakness:</strong> Takes time. Small sample sizes can be less reliable.</div>
        </div>
        <div class="learn-card lv2">
          <div class="learn-card-icon">&#128218;</div>
          <div class="learn-card-title">Secondary Research</div>
          <div class="learn-card-body">Research collected by someone else that you find and use. It gives you broader context, existing knowledge, and data you couldn't collect yourself.<br><br><strong>Examples:</strong> Books, websites, articles, product reviews, government reports, material data sheets.<br><br><strong>Strength:</strong> Quick to access. Often based on large datasets.<br><strong>Weakness:</strong> May not be specific to your problem. Can be outdated or biased.</div>
        </div>
      </div>
      <div class="learn-h2">&#128300; How to Write a Good Survey (Primary Research)</div>
      <div class="learn-cards cols2">
        <div class="learn-card lv4"><div class="learn-card-icon">&#9989;</div><div class="learn-card-title">Good Survey Practices</div><div class="learn-card-body">Ask closed questions that give you data (numbers). Target the right people — your actual client group. Aim for at least 10-15 responses. Ask about needs and priorities, not just opinions. Include a Likert scale (1-5 ratings) for measurable data.</div></div>
        <div class="learn-card lv1"><div class="learn-card-icon">&#10060;</div><div class="learn-card-title">Common Survey Mistakes</div><div class="learn-card-body">Asking leading questions: "Don't you think X is important?" Asking too many questions (respondents rush). Only surveying friends (biased sample). Not connecting findings to your design decisions. Collecting data but never analysing it.</div></div>
      </div>
    </div>

    <!-- ══ CITING ══ -->
    <div class="learn-section" id="sec-citing">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#128218; Research Skills</div>
        <div class="learn-art-title">How to Cite Your Sources</div>
        <div class="learn-art-sub">Citing sources shows that your research is real, credible, and respectful of other people's work. It also protects you from accusations of plagiarism. Every fact or image you use from an outside source should be cited.</div>
      </div>

      <div class="learn-callout warn">
        <div class="lc-lbl">&#9888; Why Citing Matters in MYP</div>
        <div class="lc-txt">The IB takes academic integrity seriously. Presenting someone else's work or data as your own — even accidentally — is plagiarism. Citing your sources is the simplest way to protect yourself and show the examiner that your research is genuine.</div>
      </div>

      <div class="learn-h2">&#128209; Citation Formats</div>
      <div class="learn-prose">MYP schools often use <strong>MLA</strong>, <strong>APA</strong>, or a simple author-date format. Check with your teacher which one your school uses. Here are examples of each for common source types:</div>

      <div class="learn-h3">Website</div>
      <div class="cite-label">MLA Format</div>
      <div class="cite-box">Author Last, First. "Article Title." Website Name, Day Month Year Published, URL. Accessed Day Month Year.
<br><br>Example: Smith, John. "How Ergonomics Affects Product Design." Design Weekly, 12 March 2023, www.designweekly.com/ergonomics. Accessed 5 January 2024.</div>
      <div class="cite-label">APA Format</div>
      <div class="cite-box">Author Last, F. I. (Year, Month Day). Article title. Website Name. URL
<br><br>Example: Smith, J. (2023, March 12). How ergonomics affects product design. Design Weekly. www.designweekly.com/ergonomics</div>

      <div class="learn-h3">Book</div>
      <div class="cite-label">MLA Format</div>
      <div class="cite-box">Author Last, First. Title of Book. Publisher, Year.
<br><br>Example: Norman, Donald. The Design of Everyday Things. Basic Books, 2013.</div>

      <div class="learn-h3">Image / Photo</div>
      <div class="cite-label">MLA Format</div>
      <div class="cite-box">Creator Last, First. "Image Title." Website Name, Year, URL.
<br><br>Example: Jones, Alice. "Red Ergonomic Chair." Unsplash, 2022, unsplash.com/photos/abc123.</div>

      <div class="learn-callout good">
        <div class="lc-lbl">&#128161; Quick Citation Tips</div>
        <div class="lc-txt">
          <strong>Keep a citation list as you research</strong> — it is much harder to find sources again afterwards.<br>
          <strong>Use a tool:</strong> Cite This For Me, NoodleTools, or MyBib.com generate citations automatically.<br>
          <strong>No author?</strong> Use the website or organisation name instead.<br>
          <strong>No date?</strong> Write "n.d." (no date) in its place.<br>
          <strong>AI tools</strong> cannot be cited as sources — they generate text, not evidence.
        </div>
      </div>
    </div>

    <!-- ══ WRITING SPECIFICATIONS ══ -->
    <div class="learn-section" id="sec-specifications">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#9989; Research Skills</div>
        <div class="learn-art-title">Writing Design Specifications</div>
        <div class="learn-art-sub">A design specification is the list of things your product MUST do or be. Strong specifications are measurable, justified, and directly connected to your research. Weak ones are vague and untestable.</div>
      </div>
      <div class="learn-cards cols2">
        <div class="learn-card lv1"><div class="learn-card-icon">&#10060;</div><div class="learn-card-title">Weak Specification</div><div class="learn-card-body">"The product must be good quality."<br><br>"The product should look nice."<br><br>"The product must be strong enough."<br><br>"The product should be affordable."<br><br>These are vague — you cannot test them or use them to judge whether your product succeeded.</div></div>
        <div class="learn-card lv4"><div class="learn-card-icon">&#9989;</div><div class="learn-card-title">Strong Specification</div><div class="learn-card-body">"The product must hold a minimum load of 3kg without deformation — tested by load test."<br><br>"The product must cost no more than $12 in materials — verified by receipts."<br><br>"The product must fit inside a standard school locker (max 320 x 200 x 150mm)."<br><br>Each one is <strong>specific</strong>, <strong>measurable</strong>, and <strong>testable</strong>.</div></div>
      </div>
      <div class="learn-h2">&#128203; The 3-Part Specification Formula</div>
      <div class="learn-callout tip">
        <div class="lc-lbl">&#128161; Formula</div>
        <div class="lc-txt"><strong>My product must [do/be WHAT] [to WHAT STANDARD/VALUE] — because [RESEARCH JUSTIFICATION].</strong><br><br>Example: "My product must be waterproof to at least IPX4 standard, tested by a 10-second spray test — because 82% of survey respondents rated waterproofing as essential."</div>
      </div>
      <div class="learn-h2">&#128300; Specification Categories</div>
      <div class="learn-cards cols3">
        <div class="learn-card"><div class="learn-card-icon">&#128736;</div><div class="learn-card-title">Function</div><div class="learn-card-body">What must the product do? What are its core jobs?</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#128179;</div><div class="learn-card-title">Cost</div><div class="learn-card-body">What is the maximum material and production cost?</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#9854;</div><div class="learn-card-title">Ergonomics</div><div class="learn-card-body">What size, weight, or grip requirements does the user need?</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#127807;</div><div class="learn-card-title">Sustainability</div><div class="learn-card-body">Are there requirements about materials, recyclability, or energy?</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#9888;</div><div class="learn-card-title">Safety</div><div class="learn-card-body">What safety standards or features must be included?</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#127912;</div><div class="learn-card-title">Aesthetics</div><div class="learn-card-body">Any colour, style, or appearance requirements from user research?</div></div>
      </div>
    </div>

    <!-- ══ DRAWING TYPES ══ -->
    <div class="learn-section" id="sec-drawing">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#9999; Design Skills</div>
        <div class="learn-art-title">Design Drawing Types</div>
        <div class="learn-art-sub">Different drawings communicate different things. Knowing which type to use — and when — makes your Criterion B work much stronger.</div>
      </div>
      <div class="learn-cards cols2">
        <div class="learn-card ca"><div class="learn-card-icon">&#9997;</div><div class="learn-card-title">Freehand Sketch</div><div class="learn-card-body">Quick, rough exploration drawings. Used when brainstorming design ideas. Not accurate but fast and useful for generating options. Always label key features.</div></div>
        <div class="learn-card cb"><div class="learn-card-icon">&#128210;</div><div class="learn-card-title">Orthographic / Working Drawing</div><div class="learn-card-body">Precise, measured drawings showing front, side, and top views separately. Used in planning drawings. Includes real dimensions. Someone could build from this.</div></div>
        <div class="learn-card cc"><div class="learn-card-icon">&#128207;</div><div class="learn-card-title">Isometric Drawing</div><div class="learn-card-body">A 3D view drawn on a grid at 30° angles. Shows height, width, and depth in one view. Great for showing what a product looks like without distortion.</div></div>
        <div class="learn-card cd"><div class="learn-card-icon">&#128308;</div><div class="learn-card-title">Exploded View</div><div class="learn-card-body">Shows all the parts of a product separated out, like an explosion frozen in time. Used to show how parts fit together and what materials each part uses.</div></div>
      </div>
      <div class="learn-callout tip">
        <div class="lc-lbl">&#128161; Annotation is Everything</div>
        <div class="lc-txt">A drawing without annotations is worth very little in MYP. <strong>Annotate</strong> means adding labels with explanations — not just "handle" but "ergonomic rubber grip — chosen because 80% of survey respondents rated grip comfort as their top priority." Every label should explain WHY, not just WHAT.</div>
      </div>
    </div>

    <!-- ══ MATERIALS ══ -->
    <div class="learn-section" id="sec-materials">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#129520; Design Skills</div>
        <div class="learn-art-title">Materials &amp; Their Properties</div>
        <div class="learn-art-sub">Choosing the right material is one of the most important design decisions. Every material has specific properties — and the best designers match material properties to the product's requirements.</div>
      </div>
      <div class="learn-cards cols3">
        <div class="learn-card"><div class="learn-card-icon">&#129522;</div><div class="learn-card-title">Hardwoods (e.g. oak, mahogany)</div><div class="learn-card-body">Strong, durable, attractive grain. Expensive. Used for furniture and high-quality products. Sustainable if FSC certified.</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#127795;</div><div class="learn-card-title">Softwoods (e.g. pine, balsa)</div><div class="learn-card-body">Lightweight, easy to cut and shape, cheaper. Less durable than hardwood. Good for models and prototypes.</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#9881;</div><div class="learn-card-title">Metals (e.g. steel, aluminium)</div><div class="learn-card-body">Strong, conductive, recyclable. Steel is very strong but heavy and rusts. Aluminium is lightweight, corrosion-resistant, but more expensive.</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#129514;</div><div class="learn-card-title">Thermoplastics (e.g. ABS, PET)</div><div class="learn-card-body">Can be melted and reshaped repeatedly. Lightweight, mouldable. ABS is used in LEGO and 3D printing. PET is used in bottles. Most are recyclable.</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#127380;</div><div class="learn-card-title">Thermosets (e.g. epoxy, polyester resin)</div><div class="learn-card-body">Harden permanently when set — cannot be melted again. Very hard and chemical-resistant. Used in circuit boards and boat hulls. Cannot be recycled.</div></div>
        <div class="learn-card"><div class="learn-card-icon">&#129525;</div><div class="learn-card-title">Textiles (e.g. cotton, nylon)</div><div class="learn-card-body">Flexible, can be woven or knitted. Cotton is natural and breathable. Nylon is synthetic, strong, and water-resistant. Used in bags, clothing, and soft products.</div></div>
      </div>
      <div class="learn-callout tip">
        <div class="lc-lbl">&#9989; Properties to Compare</div>
        <div class="lc-txt">When justifying your material choice, compare: <strong>strength</strong> (tensile, compressive), <strong>hardness</strong>, <strong>density/weight</strong>, <strong>thermal conductivity</strong>, <strong>electrical conductivity</strong>, <strong>corrosion resistance</strong>, <strong>cost</strong>, <strong>workability</strong>, and <strong>sustainability</strong>. Saying "I chose aluminium because it is lightweight and corrosion-resistant, which meets my size and durability criteria" is much stronger than just saying "aluminium is a good material."</div>
      </div>
    </div>

    <!-- ══ TESTING ══ -->
    <div class="learn-section" id="sec-testing">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#128300; Design Skills</div>
        <div class="learn-art-title">Product Testing Methods</div>
        <div class="learn-art-sub">Testing is the core of Criterion D. The best tests generate real data that can be directly compared to your specification criteria. Here are the main types and how to use them.</div>
      </div>
      <div class="learn-cards cols2">
        <div class="learn-card lv3"><div class="learn-card-icon">&#128200;</div><div class="learn-card-title">Quantitative Testing</div><div class="learn-card-body">Produces numbers. The best type for evaluating specifications because you can compare directly to your target values.<br><br><strong>Examples:</strong> Load tests (kg), dimension checks (mm), timing tests (seconds), cost receipts ($), user ratings (1-5 scale), cycle tests (number of uses).</div></div>
        <div class="learn-card lv2"><div class="learn-card-icon">&#128172;</div><div class="learn-card-title">Qualitative Testing</div><div class="learn-card-body">Produces opinions and descriptions. Useful for aesthetic and usability criteria that are hard to measure with numbers.<br><br><strong>Examples:</strong> User feedback forms, focus groups, expert reviews, peer evaluations. Best when combined with quantitative data.</div></div>
        <div class="learn-card lv4"><div class="learn-card-icon">&#128100;</div><div class="learn-card-title">User Testing</div><div class="learn-card-body">Giving your product to real users from your target audience and observing or recording their experience. Powerful for identifying usability issues the designer never noticed.<br><br><strong>Best practice:</strong> At least 5 users, standardised tasks, record both completion time and errors.</div></div>
        <div class="learn-card lv1"><div class="learn-card-icon">&#128483;</div><div class="learn-card-title">Destructive Testing</div><div class="learn-card-body">Testing a product to failure — finding the point at which it breaks. Useful for durability and safety testing.<br><br><strong>Examples:</strong> Maximum load test, drop test, scratch resistance test, UV degradation test.</div></div>
      </div>
      <div class="learn-callout tip">
        <div class="lc-lbl">&#128161; The Golden Rule of Testing</div>
        <div class="lc-txt">Every test must link back to a specific specification criterion. If you cannot say "this test measures Criterion X which has a target value of Y", the test is not useful for your evaluation. Design your tests BEFORE you build your solution — not after.</div>
      </div>
    </div>

    <!-- ══ AI + INTEGRITY ══ -->
    <div class="learn-section" id="sec-ai-integrity">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#129302; Using AI Wisely</div>
        <div class="learn-art-title">AI &amp; Academic Integrity</div>
        <div class="learn-art-sub">AI tools like ChatGPT and Claude can be powerful learning assistants — or they can do your thinking for you, which is a problem. Here's how to stay on the right side of the line.</div>
      </div>

      <div class="learn-callout warn">
        <div class="lc-lbl">&#9888; The IB Rule</div>
        <div class="lc-txt">The IB requires that all submitted work is <strong>your own</strong>. Using AI to generate your design brief, write your evaluation, or produce your analysis and submitting it as your own work is academic dishonesty — regardless of how good it looks. You must be able to explain and defend every sentence you submit.</div>
      </div>

      <div class="learn-h2">&#9989; What AI Can Legitimately Help With</div>
      <div class="learn-cards cols2">
        <div class="learn-card lv2"><div class="learn-card-icon">&#128218;</div><div class="learn-card-title">Understanding Concepts</div><div class="learn-card-body">Ask AI to explain a concept you don't understand. "Explain what ergonomics means with an example." This is like asking a teacher — you then write the explanation in your own words.</div></div>
        <div class="learn-card lv2"><div class="learn-card-icon">&#128172;</div><div class="learn-card-title">Getting Feedback</div><div class="learn-card-body">Paste YOUR work and ask AI to give feedback. "What is weak about my justification?" Then YOU improve it. The work stays yours.</div></div>
        <div class="learn-card lv2"><div class="learn-card-icon">&#128300;</div><div class="learn-card-title">Brainstorming Ideas</div><div class="learn-card-body">Use AI to generate a list of possible ideas you could consider, then choose and develop your OWN idea. "What are 10 possible design ideas for a portable study organiser?" You still design and justify it yourself.</div></div>
        <div class="learn-card lv2"><div class="learn-card-icon">&#128269;</div><div class="learn-card-title">Research Starting Points</div><div class="learn-card-body">Ask AI for directions to look: "What materials are commonly used in reusable water bottles?" — then go find and cite the actual sources yourself. AI is a pointer, not a source.</div></div>
      </div>

      <div class="learn-h2">&#10060; What You Cannot Do</div>
      <div class="learn-cards cols2">
        <div class="learn-card lv1"><div class="learn-card-icon">&#128683;</div><div class="learn-card-title">Generate Your Written Work</div><div class="learn-card-body">Asking AI to "write my design brief", "write my evaluation", or "write my justification" and submitting it is academic dishonesty. It doesn't matter if you edit it slightly — if the core thinking isn't yours, it's dishonest.</div></div>
        <div class="learn-card lv1"><div class="learn-card-icon">&#128683;</div><div class="learn-card-title">Cite AI as a Source</div><div class="learn-card-body">AI generates plausible-sounding text — it is not a reliable source of facts. It cannot be cited. If AI tells you a statistic, you must independently verify it from a real, citable source before using it.</div></div>
        <div class="learn-card lv1"><div class="learn-card-icon">&#128683;</div><div class="learn-card-title">Let AI Make Your Decisions</div><div class="learn-card-body">Asking AI "which design should I choose?" and using its answer means the design decisions aren't yours. Examiners are assessing YOUR thinking and YOUR judgement — not an AI's.</div></div>
        <div class="learn-card lv1"><div class="learn-card-icon">&#128683;</div><div class="learn-card-title">Use AI for Testing Data</div><div class="learn-card-body">Your product testing must use REAL products producing REAL data. AI cannot test your product. Any testing data must come from actual physical tests you performed.</div></div>
      </div>
    </div>

    <!-- ══ AI FOR EACH CRITERION ══ -->
    <div class="learn-section" id="sec-ai-criteria">
      <div class="learn-art-hdr">
        <div class="learn-art-badge">&#127919; Using AI Wisely</div>
        <div class="learn-art-title">How AI Can Help — By Criterion</div>
        <div class="learn-art-sub">Here are specific, academically honest ways you can use AI as a thinking partner for each criterion and strand — without letting it do your work for you.</div>
      </div>
      <div id="aiAccordion">

        <div class="ai-crit">
          <div class="ai-crit-hdr" onclick="toggleAI(this)">
            <div class="ai-crit-badge" style="background:#e4f5fb;color:#0e5878;">A</div>
            <div class="ai-crit-name">Criterion A — Inquiring &amp; Analyzing</div>
            <div class="ai-crit-arrow">&#9658;</div>
          </div>
          <div class="ai-crit-body">
            <div class="ai-strand" style="background:#e4f5fb;border-color:#7ecce8;">
              <div class="ai-strand-title" style="color:#0e5878;">Strand 1: Explain and Justify the Need</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI to explain what "justify" means with an example, so you understand the standard before you write.</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Paste YOUR written need statement and ask AI "Is this a justification or just a description? What is missing?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to "write the justification for my need" and submit it.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"I wrote: [your text]. I am aiming for the 7-8 band which requires justification. What reasoning or evidence am I missing that would make this a justification rather than just a description?"</div></div>
            </div>
            <div class="ai-strand" style="background:#e4f5fb;border-color:#7ecce8;">
              <div class="ai-strand-title" style="color:#0e5878;">Strand 2: Research Plan</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI for a list of possible research topics related to your problem — then YOU decide which are most important and justify your prioritisation.</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to write your research plan for you.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"My design problem is [problem]. What are possible areas I could research? Give me 10 ideas." Then select and rank them yourself, explaining your reasoning.</div></div>
            </div>
            <div class="ai-strand" style="background:#e4f5fb;border-color:#7ecce8;">
              <div class="ai-strand-title" style="color:#0e5878;">Strand 3: Analyse Existing Products</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI to explain what the ACCESS FM letters mean so you understand the framework fully.</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI "what are common weaknesses in existing [type] products that I should look for?" — then do your own physical analysis.</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to analyse a product for you. Your analysis must come from your own observation of real products.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"I am analysing a [product type]. Using ACCESS FM as a framework, what questions should I be asking about each letter? Don't analyse it for me — just give me good questions to guide my own observation."</div></div>
            </div>
            <div class="ai-strand" style="background:#e4f5fb;border-color:#7ecce8;">
              <div class="ai-strand-title" style="color:#0e5878;">Strand 4: Design Brief</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI to review your draft brief and identify gaps: "What connections between research and design direction are unclear?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to write your design brief — this is the central document that shows your thinking.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"Here is my draft design brief: [paste text]. Does every sentence connect my research findings to a design direction? What is still vague or unsupported?"</div></div>
            </div>
          </div>
        </div>

        <div class="ai-crit">
          <div class="ai-crit-hdr" onclick="toggleAI(this)">
            <div class="ai-crit-badge" style="background:#fef3c7;color:#7a5000;">B</div>
            <div class="ai-crit-name">Criterion B — Developing Ideas</div>
            <div class="ai-crit-arrow">&#9658;</div>
          </div>
          <div class="ai-crit-body">
            <div class="ai-strand" style="background:#fef3c7;border-color:#f0d060;">
              <div class="ai-strand-title" style="color:#7a5000;">Strand 1: Design Specification</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI to check whether your criteria are measurable: "Is 'my product must be strong' testable? How could I make it more specific?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to write your specification — it must come from YOUR research findings.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"Here are my design specifications: [list]. Which of these are vague or untestable? Suggest how I could make each one more specific and measurable without changing what I intend."</div></div>
            </div>
            <div class="ai-strand" style="background:#fef3c7;border-color:#f0d060;">
              <div class="ai-strand-title" style="color:#7a5000;">Strand 2 &amp; 3: Design Ideas and Selection</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI for inspiration: "What design features exist in [product type] that address [specific need]?" — then create YOUR own original designs.</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI to check your justification: "Does this explain WHY I chose this design, or just WHAT it is?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Submit AI-generated design ideas or ask AI to choose your best design.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"I chose Design C. Here is my justification: [paste text]. Am I explaining WHY this design beats the others, or just describing it? What specific criteria comparisons am I missing?"</div></div>
            </div>
          </div>
        </div>

        <div class="ai-crit">
          <div class="ai-crit-hdr" onclick="toggleAI(this)">
            <div class="ai-crit-badge" style="background:#e2f7ec;color:#146832;">C</div>
            <div class="ai-crit-name">Criterion C — Creating the Solution</div>
            <div class="ai-crit-arrow">&#9658;</div>
          </div>
          <div class="ai-crit-body">
            <div class="ai-strand" style="background:#e2f7ec;border-color:#82d8a4;">
              <div class="ai-strand-title" style="color:#146832;">Strand 1: Production Plan</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI "What should a detailed production plan include for a student making a [product type]?" — then build your own plan.</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to write your plan — it must reflect your actual making process with your real tools and materials.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"Here is my production plan: [paste]. Is it specific enough for a peer to follow step by step? What is missing in terms of time estimates, materials, or sequencing?"</div></div>
            </div>
            <div class="ai-strand" style="background:#e2f7ec;border-color:#82d8a4;">
              <div class="ai-strand-title" style="color:#146832;">Strand 4: Justifying Changes</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI: "I changed [X] to [Y] during making. How should I structure this as a justified change in my write-up?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to invent changes or write your changes documentation — these must be real changes that actually happened.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"I changed the width from 30cm to 35cm because the laptop didn't fit. Here's what I wrote: [paste]. Does this justify the change or just describe it? What evidence or reasoning should I add?"</div></div>
            </div>
          </div>
        </div>

        <div class="ai-crit">
          <div class="ai-crit-hdr" onclick="toggleAI(this)">
            <div class="ai-crit-badge" style="background:#fdeaea;color:#7a1010;">D</div>
            <div class="ai-crit-name">Criterion D — Evaluating</div>
            <div class="ai-crit-arrow">&#9658;</div>
          </div>
          <div class="ai-crit-body">
            <div class="ai-strand" style="background:#fdeaea;border-color:#f4aac8;">
              <div class="ai-strand-title" style="color:#7a1010;">Strand 1: Testing Methods</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI: "What types of tests could measure [specific criterion]?" — then design your own test methodology.</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Use AI-generated testing data — all data must come from real physical tests.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"My specification says the product must hold 3kg. What are different ways I could test this? I want to design a test that generates numerical data. Give me 3 options and I'll choose one."</div></div>
            </div>
            <div class="ai-strand" style="background:#fdeaea;border-color:#f4aac8;">
              <div class="ai-strand-title" style="color:#7a1010;">Strand 2: Evaluating Success</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Paste your evaluation draft and ask AI: "Am I being critical enough? Where am I just describing results instead of evaluating them?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to evaluate your product — only you have the actual test results.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"Here is my evaluation: [paste]. For a 7-8 score, I need to critically evaluate against all criteria with authentic data. Which criteria am I not evaluating fully, and where am I missing honest critique of failures?"</div></div>
            </div>
            <div class="ai-strand" style="background:#fdeaea;border-color:#f4aac8;">
              <div class="ai-strand-title" style="color:#7a1010;">Strand 3 &amp; 4: Improvements and Impact</div>
              <div class="ai-do yes">&#9989; <strong>You can:</strong> Ask AI: "What factors should I consider when writing about the impact of a design solution on its target audience?"</div>
              <div class="ai-do no">&#10060; <strong>You cannot:</strong> Ask AI to write your improvements or impact sections — these must come from your actual evaluation findings and real user feedback.</div>
              <div class="ai-prompt-box"><div class="ai-prompt-lbl">&#128172; Try this prompt instead:</div><div class="ai-prompt">"My product partially failed the weight criterion. Here's my improvement idea: [paste]. Is this a description of what to change, or a justified improvement that explains why it will fix the problem and how it could be tested?"</div></div>
            </div>
          </div>
        </div>

      </div><!-- /aiAccordion -->
    </div><!-- /sec-ai-criteria -->

  </div><!-- /learn-content -->
</div><!-- /learn-layout -->
</div><!-- /panelLearn -->

<script>
var CT = {
  "state":     {lv:1,lbl:"State",     s:"Just say it clearly - one short answer. No need to explain why.",
    ex:{1:"The purpose of my product is to carry a water bottle - one clear sentence, done!",2:"The need is that students have no way to store their devices safely at school.",3:"The problem exists because the client has no accessible storage for their equipment.",4:"The need arises because students aged 11-16 lack a safe, portable place to store devices - direct and specific to the client."}},
  "states":    {lv:1,lbl:"States",    s:"Just says it clearly - one short answer.",
    ex:{1:"States: the solution must be waterproof - one fact.",2:"States the main features: the product is red, plastic, and lightweight.",3:"States the success: the product met 4 out of 5 criteria.",4:"States and prioritizes the most important research first, then explains briefly why each was chosen."}},
  "define":    {lv:1,lbl:"Define",    s:"Give the exact meaning - like a dictionary. What does this word actually mean?",
    ex:{1:"Ergonomics: the study of how to design things so they are comfortable and easy for people to use.",2:"Primary research: information I collect myself, for example through a survey I created.",3:"Design specification: a detailed list of requirements that the final product must meet.",4:"Target audience: the specific group of people for whom a product is being designed, defined by age, needs, and context."}},
  "defines":   {lv:1,lbl:"Defines",   s:"Gives the exact meaning of something - a clear, dictionary-style answer.",
    ex:{1:"Defines the test: a drop test checks if the product survives being dropped from 1 metre.",2:"Defines a relevant test: a user survey with 10 questions about comfort and ease of use.",3:"Defines testing methods: three tests - a strength test, usability test, and client feedback form.",4:"Defines and explains why each test was chosen based on the design specification criteria."}},
  "list":      {lv:1,lbl:"List",      s:"Write things down one by one. Short items only - no details or reasons needed.",
    ex:{1:"Materials needed: cardboard, scissors, glue, ruler, pencil.",2:"Success criteria: 1. Must be waterproof. 2. Must fit in a backpack. 3. Must cost under $10.",3:"Changes made: 1. Wider handle. 2. Lighter material. 3. Added a clasp.",4:"Prioritized research list: 1. User needs survey. 2. Existing product analysis. 3. Material costs."}},
  "lists":     {lv:1,lbl:"Lists",     s:"Writes things down one by one - no details or reasons needed.",
    ex:{1:"Lists two basic criteria: must be colourful and must be small.",2:"Lists success criteria: strong, waterproof, affordable, easy to use.",3:"Lists how the solution could be improved: add a strap, change the colour, use recycled material.",4:"Lists changes with a brief reason for each: changed handle (too slippery), resized lid (hard to open)."}},
  "outline":   {lv:2,lbl:"Outline",   s:"Give a quick overview - the main points only. Don't go too deep into details.",
    ex:{1:"My product is a pencil case. It opens with a zip and holds 20 pencils - main points only.",2:"The main steps are: research, design, build, test, evaluate. Each takes about one week.",3:"The plan outlines three phases: planning (week 1), making (weeks 2-3), and testing (week 4).",4:"The plan outlines how time and resources are split: 40% design, 40% making, 20% testing - with reasoning."}},
  "outlines":  {lv:2,lbl:"Outlines",  s:"Gives a quick overview - main points only, no deep detail.",
    ex:{1:"Outlines the need: students need a safer way to carry their laptops.",2:"Outlines the main findings: most users prefer lightweight bags with easy access.",3:"Outlines how the solution could be improved: make it lighter and add a waterproof lining.",4:"Outlines how time and resources were efficiently used, with key decisions noted at each stage."}},
  "present":   {lv:2,lbl:"Present",   s:"Show or share your work clearly so other people can understand it.",
    ex:{1:"Here is my design drawing with labels showing the front, side, and back views.",2:"I present three design ideas below, each with labelled diagrams and a short description.",3:"I present my chosen design with annotated sketches and a written explanation of each feature.",4:"I present my final design with detailed technical drawings, annotations, and justification for every choice."}},
  "presents":  {lv:2,lbl:"Presents",  s:"Shows or shares work clearly so other people can understand it.",
    ex:{1:"Presents one design idea: a rough sketch of a box with a lid.",2:"Presents three feasible design ideas with labels and a brief description of each.",3:"Presents the chosen design with labelled drawings and reasons for key features.",4:"Presents the final design with full technical drawings, detailed annotations, and specification links."}},
  "construct": {lv:2,lbl:"Construct", s:"Build or put something together in a clear, step-by-step order.",
    ex:{1:"Construct a basic plan: Step 1 - cut, Step 2 - fold, Step 3 - glue.",2:"I constructed a research plan with 4 steps and listed what I needed to find out in each.",3:"I constructed a logical plan using a Gantt chart showing tasks, deadlines, and materials needed.",4:"I constructed a detailed plan that maps out every step, resource, and timeline, with contingency notes."}},
  "constructs":{lv:2,lbl:"Constructs",s:"Builds or puts something together in a clear, step-by-step order.",
    ex:{1:"Constructs a basic plan with 3 steps for making the solution.",2:"Constructs a research plan listing primary and secondary sources to investigate.",3:"Constructs a logical plan that considers time and materials needed for each stage.",4:"Constructs a detailed plan that describes efficient use of time, with reasoning for each decision."}},
  "develop":   {lv:2,lbl:"Develop",   s:"Start with a basic idea and make it grow - add more detail and improve it.",
    ex:{1:"I started with a sketch, then added colour, size notes, and material ideas.",2:"I developed my design by testing two versions and improving the handle width based on feedback.",3:"I developed design specifications by researching user needs, safety standards, and material costs.",4:"I developed a detailed brief that brings together all research findings and links them to design criteria."}},
  "develops":  {lv:2,lbl:"Develops",  s:"Starts with a basic idea and makes it grow - adds more detail and improves it.",
    ex:{1:"Develops a few success criteria based on the brief: must be durable, cheap, and easy to use.",2:"Develops design specifications with clear, testable criteria linked to user needs.",3:"Develops a range of design ideas with annotations explaining how each meets the specification.",4:"Develops a detailed design brief that brings together and connects all research findings."}},
  "explain":   {lv:3,lbl:"Explain",   s:"Say WHAT it is AND WHY or HOW - always give reasons. Facts alone are not enough!",
    ex:{1:"I chose this material because it is cheap and easy to cut, which suits my budget and tools.",2:"The design failed criterion 2 because the base was too narrow, causing it to tip over easily.",3:"The product succeeded because the ergonomic handle reduced hand fatigue, which directly addressed the client's main complaint.",4:"I explain why each change was made: the handle was widened because user testing showed 70% of participants found it uncomfortable to hold."}},
  "explains":  {lv:3,lbl:"Explains",  s:"Says WHAT and WHY or HOW - gives clear reasons, not just facts.",
    ex:{1:"Explains the need: students struggle to carry heavy bags, which causes back pain.",2:"Explains the success: the product met 4 criteria because the materials were strong and the size was correct.",3:"Explains how the solution could be improved: adding a shoulder strap would distribute weight more evenly.",4:"Explains the impact on the client: the solution saved them 15 minutes per day and reduced errors by 30%, based on testing."}},
  "describe":  {lv:3,lbl:"Describe",  s:"Paint a detailed picture - talk about features, qualities, and what you notice.",
    ex:{1:"The product is a red, rectangular box, 20cm long, with a snap-close lid and two compartments.",2:"The product has a curved handle made from soft rubber, a matte black finish, and a non-slip base.",3:"The solution could be improved by replacing the plastic clasp with a magnetic closure, which would be faster and more durable.",4:"Describes the impact on the client: they reported the product was easier to use, saved them time, and matched their preferences."}},
  "describes": {lv:3,lbl:"Describes", s:"Paints a detailed picture - covers features, qualities, and observations.",
    ex:{1:"Describes the product: a blue pouch with a drawstring, made from canvas, 15cm x 20cm.",2:"Describes the testing method: I asked 10 users to rate ease of use from 1 to 5 after using the product.",3:"Describes the impact: users found the product reduced setup time from 5 minutes to under 1 minute.",4:"Describes detailed testing methods: three separate tests with different user groups, each generating numerical data."}},
  "identify":  {lv:3,lbl:"Identify",  s:"Spot it and name it - pick the right thing out from a group or situation.",
    ex:{1:"I identified the main problem: students cannot find a quiet place to study at lunchtime.",2:"I identified the primary research I need: a survey of 20 students about their study habits.",3:"I identified and prioritized the key research areas: user needs first, then material costs, then safety standards.",4:"I identified all primary and secondary research needed and explained why each piece is relevant to my design."}},
  "identifies":{lv:3,lbl:"Identifies",s:"Spots it and names it - picks the right thing out.",
    ex:{1:"Identifies the main feature: the product must be waterproof.",2:"Identifies success criteria that match the design brief: must hold 2kg, be under $15, and fit in a locker.",3:"Identifies and outlines the primary and secondary research needed with a brief reason for each.",4:"Identifies all research with detailed justification for why each source is the most relevant."}},
  "analyse":   {lv:4,lbl:"Analyse",   s:"Break it apart and look at how ALL the pieces connect. Go much deeper than just describing!",
    ex:{1:"The existing water bottle has a wide mouth (easy to fill), a rubber grip (non-slip), but a flimsy cap (will break quickly). The best feature to copy is the grip because it solves my client's main issue.",2:"I analysed three similar products. The most successful had a modular design, which means parts can be replaced. This matters because it reduces waste and long-term cost.",3:"I analysed a range of existing products and found that all successful ones share two features: ergonomic handles and modular components. This directly informs my design specification.",4:"I analysed a range of products in detail, comparing material choices, ergonomics, cost, and sustainability. The most effective solutions balance all four factors, which shaped my entire design brief."}},
  "analyses":  {lv:4,lbl:"Analyses",  s:"Breaks it apart and looks at how the pieces connect - goes deeper than describing.",
    ex:{1:"Analyses one product: it is lightweight but breaks easily. This tells me I need a stronger material.",2:"Analyses a group of similar products: all three use velcro, but only one is waterproof. The waterproof version is most popular, so I will include this feature.",3:"Analyses a range of products in detail, comparing features, materials, and user ratings to draw clear conclusions.",4:"Analyses a range of existing products in detail, identifying patterns, trade-offs, and innovations that directly inform the design specification."}},
  "justify":   {lv:4,lbl:"Justify",   s:"Give strong evidence and clear reasons to PROVE why your choice is the right one.",
    ex:{1:"I chose design B because it is the only one that meets all 5 of my success criteria.",2:"I chose aluminium over plastic because it is stronger, lighter, and recyclable, which matches my sustainability criterion.",3:"I justify my design selection: it scored highest in user testing (8.5/10), met all 5 criteria, and was the most cost-effective option.",4:"I fully justify all design choices with reference to specific criteria, user feedback data, and material testing results. Each decision is linked directly to the design specification."}},
  "justifies": {lv:4,lbl:"Justifies", s:"Gives strong evidence and clear reasons to PROVE why a choice is the right one.",
    ex:{1:"Justifies the design: it was chosen because it is the simplest to make with available tools.",2:"Justifies the selection: design A was chosen because it met 4 out of 5 criteria and scored highest in the peer review.",3:"Justifies each change: the handle was moved because testing showed 8 out of 10 users found the original position awkward.",4:"Fully justifies all changes and decisions with detailed reference to testing data, user feedback, and design specification criteria."}},
  "evaluate":  {lv:4,lbl:"Evaluate",  s:"Look at BOTH the good things AND the not-so-good things, then make a fair judgement. Be honest!",
    ex:{1:"The product works well because it holds all the pencils. However, the zip broke during testing. Overall it partially meets the brief.",2:"The solution met 3 of 5 criteria. It was strong and lightweight, but too expensive and the colour choice was unpopular.",3:"I evaluate my solution: it successfully met the ergonomic and cost criteria, but failed the durability criterion - the hinge broke after 50 uses. I recommend reinforcing it with metal screws.",4:"I critically evaluate my solution against all 6 design specification criteria using authentic test data. It fully met 4, partially met 1 (cost was 15% over budget), and failed 1 (weight). I provide specific improvement recommendations for each failure."}},
  "evaluates": {lv:4,lbl:"Evaluates", s:"Looks at both the strengths and weaknesses, then makes a fair, honest judgement.",
    ex:{1:"Evaluates: the product works but the handle is too small for adult hands.",2:"Evaluates success: the product met the size and weight criteria but failed the waterproof test.",3:"Critically evaluates: the solution met 4 criteria and failed 2. The main failure was cost - it was $3 over budget.",4:"Critically evaluates the success of the solution against all specification criteria using authentic product testing data, with detailed reasoning for each outcome."}},
  "design":    {lv:4,lbl:"Design",    s:"Create a detailed, thoughtful plan with a clear purpose - think it all the way through!",
    ex:{1:"Design a drop test: drop the product from 1 metre 5 times and check for damage.",2:"Design a usability test: ask 10 users to complete 3 tasks, time each task, and rate difficulty from 1 to 5.",3:"Design relevant testing methods: a strength test, a user survey with 10 questions, and a durability test with 100 open/close cycles.",4:"Design detailed and relevant testing methods for all 6 specification criteria, each generating quantitative data that can be directly compared to the target values."}},
  "designs":   {lv:4,lbl:"Designs",   s:"Creates a detailed, thoughtful plan with a clear purpose.",
    ex:{1:"Designs a test: puts the product under running water for 1 minute to check waterproofing.",2:"Designs a relevant test: measures grip strength needed to open the lid 20 times with different users.",3:"Designs relevant testing methods that generate numerical data for each success criterion.",4:"Designs detailed and relevant testing methods that generate accurate, reliable data for every criterion in the design specification."}},
  "prioritize":{lv:4,lbl:"Prioritize",s:"Put things in order from MOST important to least important, and explain why.",
    ex:{1:"I prioritize user safety first, then cost, then aesthetics - because a product that hurts someone is worthless.",2:"I prioritize primary research (my own survey) over secondary research because it is specific to my client.",3:"I prioritize: 1. User needs survey (most important), 2. Existing product analysis (second), 3. Material costs (third). Each ranked with reasons.",4:"I prioritize all research areas based on relevance to my design brief, explaining the impact each will have on my final specification decisions."}},
  "prioritizes":{lv:4,lbl:"Prioritizes",s:"Puts things in order from most important to least, and explains why.",
    ex:{1:"Prioritizes: safety over aesthetics because the product is used by young children.",2:"Prioritizes primary and secondary research, with primary listed first because it is more directly relevant.",3:"Prioritizes research by impact: user needs first, materials second, costs third - each ranked with a brief explanation.",4:"Prioritizes all research areas with detailed justification for the ranking based on their influence on the design specification."}},
  "summarize": {lv:4,lbl:"Summarize", s:"Bring together all the key points into one short, clear wrap-up.",
    ex:{1:"In summary: my research showed that users want something cheap, small, and easy to use.",2:"To summarize: the analysis found that existing products are either too expensive or too fragile, leaving a gap for my design.",3:"I summarize the analysis: three key themes emerged - users prioritize portability, durability, and low cost. These form the basis of my design specification.",4:"I summarize the detailed analysis of all research, identifying the three most critical insights and explaining how each directly shapes a specific design specification criterion."}},
  "summarizes":{lv:4,lbl:"Summarizes",s:"Brings together all the key points into a short, clear wrap-up.",
    ex:{1:"Summarizes the findings in two sentences: users need a portable solution. Cost must stay under $5.",2:"Summarizes analysis of relevant research: the key finding is that users aged 12-16 prefer simple, one-handed operation.",3:"Summarizes the analysis clearly, pulling out the most important findings and linking them to design decisions.",4:"Summarizes a detailed analysis by identifying the core insights across all research sources and mapping them to specific design specification criteria."}}
};

var LBL   = ["1-2 Not Yet There","3-4 Meeting","5-6 Exceeding","7-8 Excelling"];
var LNAME = ["Not Yet There","Meeting","Exceeding","Excelling"];
var LCLS  = ["lv1","lv2","lv3","lv4"];
var GLBL  = {MYP1:"MYP 1 (Grade 6)",MYP3:"MYP 3 (Gr. 7-8)",MYP5:"MYP 5 (Gr. 9-10)"};
var CCOL  = {A:"#29a8d4",B:"#d49800",C:"#28a85e",D:"#e03c3c"};
var CBG   = {A:"#e4f5fb",B:"#fef3c7",C:"#e2f7ec",D:"#fdeaea"};

var PROG_NOTES = {
  A:{
    0:{1:"Starting point: just SAY the need exists - one clear statement. No reasons or depth needed yet.",
       2:"Step up! Now give a quick OVERVIEW of why the need exists - the main points around it, not just a single statement.",
       3:"Bigger jump! Now you must EXPLAIN WHY the need exists - reasons, causes, and context. Link the problem to the real world.",
       4:"The highest bar! Both EXPLAIN deeply AND JUSTIFY with strong reasoning and evidence. Why does this specific client need this solution, and why does it matter?"},
    1:{1:"Starting level: just WRITE DOWN your research findings. No plan needed - just show what you found.",
       2:"Now IDENTIFY what research you need to do - but with some teacher help. You are starting to think ahead.",
       3:"Big step! Now independently BUILD a research plan and RANK what is most important. You are organising your own thinking.",
       4:"The top! Fully independent, detailed research plan. Explain WHY each piece of research matters and rank them with clear reasons. No help needed."},
    2:{1:"Not applicable at this level.",
       2:"Look at ONE existing product and pick out its main features. Simple identification - no deep thinking yet.",
       3:"Now look at a RANGE of products and DESCRIBE them - features, qualities, comparisons. More thorough than one product.",
       4:"Go deep! ANALYSE many products - break down what works, what does not, and WHY. Find patterns and draw conclusions that inform your own design."},
    3:{1:"Not applicable at this level.",
       2:"Give a quick OVERVIEW (outline) of some of the key research findings. Just the highlights - no depth.",
       3:"Outline ALL the main research findings, not just some. More complete coverage.",
       4:"Bring everything together - SUMMARISE the full analysis of all your research into a clear, connected design brief. Show how your research led to your design decisions."}
  },
  B:{
    0:{1:"Write ONE basic success criterion. Just one! The start of understanding what the product must do.",
       2:"A few criteria - still simple. You are starting to list what matters but without much detail or research backing.",
       3:"Start to DEVELOP the criteria - making them more specific, measurable, and meaningful. Getting more rigorous.",
       4:"A full, detailed specification. Every criterion is explained, linked to research evidence, and clearly testable. Nothing vague."},
    1:{1:"Show ONE design idea that someone else can understand. Basic but a real starting point.",
       2:"Multiple ideas now! You label features or use a medium so others can follow. Quantity and clarity both improve.",
       3:"A RANGE of feasible ideas - each one realistic and labelled with key features explained. Not just sketches.",
       4:"Full range of ideas with detailed annotation. Each idea is clearly presented, thoroughly labelled, and correctly interpreted by any reader."},
    2:{1:"You have started making a planning drawing, but it is incomplete. That is okay - it is the beginning.",
       2:"You CHOOSE a design and state its key features. Simple selection with basic description.",
       3:"You present the chosen design and outline WHY you chose it, with reference to your specification.",
       4:"Full justification - explain AND prove why your chosen design is the best option, with detailed links to every relevant criterion in your specification."},
    3:{1:"Not applicable at this level.",
       2:"A planning drawing OR a list of requirements. One or the other - you are beginning to show HOW you will make it.",
       3:"Both a drawing AND a list of requirements. More complete - someone else could follow this.",
       4:"Accurate, detailed drawings AND a thorough outline of requirements. Another student could use this to build your solution."}
  },
  C:{
    0:{1:"Minimal skills shown. Work is incomplete or poorly planned.",
       2:"You LIST the main steps but a peer would struggle to follow. It is there, but not clear enough.",
       3:"Your steps are clear enough that a peer COULD follow them. Time and resources are considered.",
       4:"A full OUTLINE of a plan - clear, considers time and resources efficiently, and a peer can successfully use it to recreate your solution."},
    1:{1:"Work functions poorly and is incomplete. A starting point, but significant improvement needed.",
       2:"Satisfactory skills - the product mostly works and is presentable, even if not perfect.",
       3:"Competent skills - the product works properly and is presented well. You are doing what was expected.",
       4:"Excellent skills - the product is made to a high standard, works exactly as intended, and is presented professionally."},
    2:{1:"Not applicable at this level.",
       2:"Product PARTIALLY works and is adequately presented. Something exists, but not fully functional.",
       3:"Product WORKS AS INTENDED and is presented appropriately. You achieved what you set out to do.",
       4:"You FOLLOWED your plan AND created a solution that works as intended. The link between planning and making is clear."},
    3:{1:"Not applicable at this level.",
       2:"You mention ONE change you made. Just one - very basic awareness that things shifted.",
       3:"You OUTLINE changes - a bit more detail, covering both design and plan changes.",
       4:"You EXPLAIN or JUSTIFY every change - not just what changed, but WHY you changed it and how it improved the solution."}
  },
  D:{
    0:{1:"You DEFINE a testing method - you say what the test is. Very basic, no data yet.",
       2:"You define a RELEVANT test that generates actual data. The test is connected to what you are measuring.",
       3:"Multiple relevant tests, all generating data. More coverage of your success criteria.",
       4:"Detailed, relevant tests - thorough, accurate, and covering all the criteria you need to measure."},
    1:{1:"You just SAY whether it worked or not. One statement - no evidence, no depth.",
       2:"You check your solution against your specification using a test. Some evidence used.",
       3:"More thorough check - describe or explain success against multiple criteria with real test data.",
       4:"Critical evaluation - go deep on every criterion, using authentic testing data. Honest about what worked AND what did not."},
    2:{1:"Not applicable at this level.",
       2:"You STATE one improvement. Just one idea - the beginning of reflective thinking.",
       3:"You OUTLINE how it could be improved. More than one point, but not deeply explained.",
       4:"You DESCRIBE or EXPLAIN improvements in detail - specific, realistic, and connected to your evaluation evidence."},
    3:{1:"Not applicable at this level.",
       2:"You STATE one way the solution impacts the client. One point - very basic.",
       3:"You OUTLINE the impact - a few key points about how the solution affects the client.",
       4:"You DESCRIBE or EXPLAIN the impact in detail - thorough, specific, and connected to your testing and evaluation."}
  }
};

var PROG_EX = {
  A:{
    0:{1:"The problem is that students at my school do not have enough storage for their devices.",
       2:"Students need a solution because they have nowhere safe to store their laptops at school. This means devices get damaged or stolen regularly.",
       3:"There is a need for a secure device storage solution because students are increasingly using personal laptops, yet the school provides no dedicated storage. This leads to theft, damage, and distraction during class.",
       4:"My target audience - MYP students aged 11-16 - need a secure, accessible device locker because current storage options are inadequate, leading to device theft (3 incidents this term). I justify this need by citing survey data showing 78% of students have experienced a storage problem, and teacher feedback confirming it disrupts learning."},
    1:{1:"I found that most students prefer lightweight bags. I also found that waterproof materials are popular.",
       2:"I need to research: what materials are waterproof, how much students can afford, and what sizes fit in school lockers. I will start with a survey of 20 students.",
       3:"Research plan: 1. User needs survey (MOST IMPORTANT - tells me what to design). 2. Existing product analysis (shows what already works). 3. Material cost comparison (limits my choices). 4. Safety standards (legal requirements). I prioritized user needs first because without understanding my client, all other research is meaningless.",
       4:"Research Plan - Prioritized by impact on design decisions: [1] User survey - PRIMARY, highest priority because it defines success criteria directly. [2] Existing product analysis - SECONDARY, identifies proven solutions I can learn from. [3] Material testing data - needed to meet durability criterion. [4] Cost benchmarking - must stay within the $15 budget constraint. Each piece of research is justified by its direct link to a specific design specification criterion."},
    2:{1:"Not applicable at this level.",
       2:"I looked at the IKEA KALLAX shelf unit. It has compartments (good for organisation), is made from particleboard (cheap but not durable), and has no lock (not secure). The compartment feature is most useful for my design.",
       3:"I looked at 5 existing device storage solutions. Most successful products share two features: security and organisation. The gap in the market is an affordable, portable, secure solution - no existing product provides all three.",
       4:"I analysed 6 existing products in detail, comparing security features, portability, durability, cost, and ergonomics. Key finding: the most successful products balance security with ease of use, but none are under $30. Products under $30 lack security features. This gap directly informs my design specification and shapes my entire design approach."},
    3:{1:"Not applicable at this level.",
       2:"My research found that students want something cheap, small, and easy to use. Most said waterproof is important.",
       3:"My design brief outlines the key research findings: user survey showed price, portability, and security are the top three priorities. Product analysis revealed no existing solution meets all three within budget. These findings will guide my design.",
       4:"Design Brief: My research analysis reveals three critical insights. First, 78% of surveyed users prioritize security over all other features. Second, no existing product under $20 includes a locking mechanism. Third, users prefer single-handed operation due to heavy backpack loads. I therefore summarise the design direction as: a sub-$15, portable, lockable device organiser, operable with one hand, targeting MYP students. Every specification criterion derives from one of these three research conclusions."}
  },
  B:{
    0:{1:"The product must be waterproof.",
       2:"Success criteria: 1. Must be waterproof. 2. Must fit in a school bag. 3. Must cost under $10. 4. Must hold at least one laptop.",
       3:"Design Specifications: 1. WATERPROOF - tested by submerging for 10 seconds without leakage. 2. PORTABLE - maximum dimensions 35x26x5cm to fit standard school bag. 3. AFFORDABLE - total material cost under $10. 4. SECURE - includes a locking mechanism that passes a 5-attempt forced-entry test.",
       4:"Detailed Design Specifications - each linked to research evidence: [1] Waterproof (IPX4 standard) - 82% of users rated waterproofing as essential in survey. Test: 10-second spray test, no internal moisture. [2] Dimensions less than 35x26x4.5cm - 90% of school bags sampled fit this size. [3] Cost under $12 - budget limit confirmed by parent survey. [4] Locking mechanism - 3 out of 3 focus group sessions identified security as primary concern."},
    1:{1:"[Rough sketch of a rectangular bag with a zip] This is my design for a device storage bag.",
       2:"Design Idea 1: A rectangular padded bag with a zip and a handle. Design Idea 2: A rigid plastic case with a snap-lock lid. Both drawn with labels showing main parts.",
       3:"Design Idea A: Soft padded neoprene sleeve with magnetic closure - lightweight, fits criterion 2. Idea B: Hard plastic case with combination lock - meets security criterion but heavier. Idea C: Fabric pouch with velcro and built-in charger pocket. All three are feasible with available materials.",
       4:"Design Idea A: Neoprene sleeve - meets criteria 1, 2, 3. Fails criterion 4 (no lock). Idea B: Rigid ABS case with 3-digit lock - meets criteria 1, 3, 4. Risk: slightly over size limit. Idea C: Canvas bag with padlock loop - meets all 4 criteria, lowest cost at $8.20. Each idea annotated with material, dimensions, estimated cost, and which criteria it meets or misses."},
    2:{1:"[Incomplete planning sketch - front view only, no labels or dimensions]",
       2:"I chose Design C - the canvas bag with padlock loop. It has a main compartment, a zip pocket, and a padlock loop on the side.",
       3:"I chose Design C because it meets 3 out of 4 specification criteria and was rated highest (4.2/5) in peer feedback. The padlock loop addresses the security criterion. The main weakness is that it is not fully waterproof - I will address this by using a waterproof canvas material.",
       4:"I chose Design C and fully justify this selection: [Criterion 1 - Waterproof] Design C uses 600D waterproof polyester. [Criterion 2 - Portable] Dimensions 34x25x4cm fit within limit. [Criterion 3 - Cost] Estimated at $9.40, within $12 budget. [Criterion 4 - Secure] Padlock loop tested with 3 different padlocks - all fit. Peer review score: 4.4/5 (highest of all three designs). Design C is the only option meeting all four criteria simultaneously."},
    3:{1:"Not applicable at this level.",
       2:"Steps to make my product: 1. Cut the fabric. 2. Sew the sides together. 3. Attach the zip. 4. Add the padlock loop. [Simple sketch showing front view with zip]",
       3:"Planning drawings: [Front view with dimensions, Side view showing depth, Exploded view showing layers]. Requirements list: 60x52cm waterproof canvas, 35cm zip, 15cm padlock loop strap, 40cm webbing handle, 4 rivets, thread.",
       4:"Accurate planning drawings (front, side, back, and exploded views - all dimensioned). Requirements: full materials list with quantities, costs, and sources. Construction sequence with notes: double-stitch all load-bearing seams; test zip function before final assembly. Another student successfully followed this plan in a trial run."}
  },
  C:{
    0:{1:"[Product attempted but not finished. Some pieces cut but not assembled. No plan submitted.]",
       2:"My plan: 1. Cut fabric. 2. Sew. 3. Add zip. 4. Attach handle. [No times, no materials listed - classmate says they could not follow it]",
       3:"My plan: Step 1 - Cut fabric pieces (30 min, need: fabric, scissors, pattern). Step 2 - Sew side seams (45 min, need: sewing machine, thread). Step 3 - Attach zip (20 min). Step 4 - Add handle and padlock loop (15 min). Total: 110 min across 2 lessons. Classmate confirmed they could follow this plan.",
       4:"Production Plan: [Gantt chart showing 4 lessons]. Each lesson has a task list, materials needed, and a time buffer for errors. Resource list per lesson included. Peer confirmed plan is followable from written instructions alone."},
    1:{1:"[Product attempted but zip is broken, sides are uneven, and lining is missing. Not usable as intended.]",
       2:"My bag is mostly complete. The zip works, the handle is attached, and it holds a laptop. The stitching is a bit uneven in places but it is functional.",
       3:"My bag is fully complete. The zip functions smoothly, all seams are even, the padlock loop is secure, and the product matches my planning drawings. Presented cleaned and pressed.",
       4:"My bag demonstrates excellent making skills: all seams are bar-tacked at stress points, the zip is double-stitched for durability, the padlock loop withstood a 5kg load test without deforming, and the waterproof coating was applied evenly. The product is identical in dimensions to my planning drawings."},
    2:{1:"Not applicable at this level.",
       2:"My bag is partially complete - the zip is attached but the padlock loop is missing. It can hold a laptop but is not yet fully secure.",
       3:"My bag functions exactly as intended - the zip works, the padlock loop is functional, it holds a 15-inch laptop, and the waterproofing was confirmed by a 10-second spray test.",
       4:"I followed my plan exactly and created a fully functional solution. The product passed all four specification tests: [1] Spray test - no moisture inside. [2] Fit test - 15-inch laptop fits. [3] Padlock test - loop accepts standard padlock. [4] Load test - handle holds 3kg without deformation."},
    3:{1:"Not applicable at this level.",
       2:"I changed the size of the main compartment because my laptop did not fit the original design.",
       3:"Changes made during making: [1] Increased main compartment from 33cm to 36cm width - laptop did not fit original dimensions. [2] Changed from velcro to zip closure - velcro did not hold under load. These changes affected both the design and the material plan.",
       4:"Changes and justifications: [1] Width increased 33 to 36cm - during cutting, test-fit revealed the laptop was 2cm too wide. Changed pattern immediately. [2] Velcro replaced with zip - after first assembly, velcro failed load test (held only 1.2kg vs 3kg target). [3] Handle strap doubled from single to double layer - single layer deformed under 2kg load during trial. All three changes improved the solution and brought it closer to meeting the original specification criteria."}
  },
  D:{
    0:{1:"My test: I will fill the bag with water and see if it leaks.",
       2:"Test 1 - Waterproof test: I will spray the bag with water for 10 seconds and check inside for moisture. This generates a pass/fail result I can compare to Criterion 1.",
       3:"Test 1 - Waterproof (Criterion 1): Spray bag for 10 seconds, check inside for moisture. Result: pass/fail. Test 2 - Load capacity (Criterion 2): Fill bag with 3kg, carry for 1 minute, check handle deformation. Test 3 - User satisfaction (Criterion 4): Ask 5 users to rate ease of use 1-5 after using bag for 5 minutes.",
       4:"Testing Plan - 4 tests, one per specification criterion: [C1 - Waterproof] Spray test (10 sec, IPX4 standard), measured with moisture detector inside. Target: 0% moisture. [C2 - Portable] Dimension verification with measuring tape, 3 measurements averaged. Target: under 35x26x4.5cm. [C3 - Cost] Material receipt comparison vs $12 budget. [C4 - Security] Padlock loop load test: 3 users apply force to locked padlock. Target: no deformation after 5kg load. Each test generates quantitative data directly comparable to the target value in the specification."},
    1:{1:"My bag works. It holds my laptop and the zip closes.",
       2:"Test 1 result: bag passed the spray test (no moisture inside). Test 2 result: bag measured 34x24x4cm - within the limit. My solution meets specification criteria 1 and 2.",
       3:"Evaluation against specification: [C1 - Waterproof] PASS - no moisture detected after spray test. [C2 - Portable] PASS - dimensions within limit. [C3 - Cost] PASS - total cost $9.40, under $12 budget. [C4 - Security] PARTIAL PASS - padlock loop held 4kg but deformed slightly at 5kg. Overall: product met 3 out of 4 criteria fully.",
       4:"Critical Evaluation - all criteria tested with authentic data (3 trials each): [C1] PASS - spray test: 0% moisture on all 3 trials. [C2] PASS - dimensions confirmed. [C3] PASS - cost $9.40 (21% under budget). [C4] PARTIAL FAIL - padlock loop deformed at 4.8kg (target 5kg). Root cause: single-layer strap insufficient. [C5] PASS - user satisfaction: 4.4/5. [C6] PARTIAL FAIL - weight 480g (target under 400g). Root cause: waterproof canvas heavier than estimated. Summary: 4 full passes, 2 partial fails. Detailed improvement recommendations provided for each failure."},
    2:{1:"Not applicable at this level.",
       2:"My bag could be improved by making the padlock loop stronger so it holds more weight.",
       3:"Improvements: [1] Reinforce padlock loop with double-layer strap - current version failed at 4.8kg vs 5kg target. [2] Reduce canvas weight by switching to 420D nylon (saves 80g, still waterproof). These two changes would address the two partial failures in my evaluation.",
       4:"Detailed Improvement Plan based on evaluation failures: [C4 - Padlock loop] Current: single-layer strap. Improvement: replace with double-layer bar-tacked strap (estimated cost +$0.40). Evidence: failed load test at 4.8kg; double-layer strap in similar products holds 8kg. [C6 - Weight] Current: 600D polyester canvas. Improvement: switch to 420D ballistic nylon - same waterproofing, weight saving of 65-80g, cost neutral. Both improvements are feasible within the original budget and would bring the product to full specification compliance."},
    3:{1:"Not applicable at this level.",
       2:"My bag helps students keep their laptops safe at school.",
       3:"Impact on target audience: [1] Students can now carry their laptops securely without risk of theft - the padlock addresses the main concern raised in my survey. [2] The lightweight design reduces additional backpack load. [3] 4 out of 5 test users said they would use this product daily.",
       4:"Impact Analysis - measured outcomes: [Security] 5/5 test users confirmed the padlock loop made them feel their laptop was secure. [Usability] Average task completion time: 8 seconds (open, store, close, lock) - one-handed operation confirmed. [Adoption] 4/5 test users said they would use this daily; 1 user requested a larger size for a 17-inch laptop. [Limitation] Product does not include a charging port, which 3/5 users requested - this would be addressed in Version 2. Overall: the solution directly addresses the identified need for 80% of target users, with one clear gap identified for future development."}
  }
};

var DATA = {
  A:{name:"Inquiring & Analyzing",strands:[
    {t:"Explain and Justify the Need",d:{
      MYP1:["states the need for a solution to a problem","outlines the need for a solution to a problem","explains the need for a solution to a problem","explains and justifies the need for a solution to a problem"],
      MYP3:["states the need for a solution to a problem","outlines the need for a solution to a problem","explains the need for a solution to a problem","explains and justifies the need for a solution to a problem"],
      MYP5:["states the need for a solution to a problem for a specified client/target audience","outlines the need for a solution to a problem for a specified client/target audience","explains the need for a solution to a problem for a specified client/target audience","explains and justifies the need for a solution to a problem for a client/target audience"]
    }},
    {t:"Identify and Prioritize Research",d:{
      MYP1:["states the findings of research","states some points of research needed to develop a solution, with some guidance","states and prioritizes the main points of research needed to develop a solution to the problem, with some guidance","states and prioritizes the main points of research needed to develop a solution to the problem, with minimal guidance"],
      MYP3:["states some of the main findings of relevant research","states the research needed to develop a solution to the problem, with some guidance","constructs a research plan, which states and prioritizes the primary and secondary research needed to develop a solution, with some guidance","constructs a research plan, which states and prioritizes the primary and secondary research needed to develop a solution independently"],
      MYP5:["develops a basic design brief, which states the findings of relevant research","outlines a research plan, which identifies primary and secondary research needed to develop a solution, with some guidance","constructs a research plan, which identifies and prioritizes primary and secondary research needed to develop a solution, with some guidance","constructs a detailed research plan, which identifies and prioritizes the primary and secondary research needed to develop a solution independently"]
    }},
    {t:"Analyze Existing Products",d:{
      MYP1:["Not Applicable","states the main features of an existing product that inspires a solution to the problem","outlines the main features of an existing product that inspires a solution to the problem","describes the main features of an existing product that inspires a solution to the problem"],
      MYP3:["Not Applicable","outlines one existing product that inspires a solution to the problem","describes a group of similar products that inspire a solution to the problem","analyses a group of similar products that inspire a solution to the problem"],
      MYP5:["Not Applicable","analyses one existing product that inspires a solution to the problem","analyses a range of existing products that inspire a solution to the problem","analyses a range of existing products that inspire a solution to the problem in detail"]
    }},
    {t:"Develop A Design Brief",d:{
      MYP1:["Not Applicable","outlines some of the main findings of research","outlines the main findings of relevant research","presents the main findings of relevant research"],
      MYP3:["Not Applicable","develops a basic design brief, which outlines some of the relevant research","develops a design brief, which outlines the findings of relevant research","develops a design brief, which presents the analysis of relevant research"],
      MYP5:["Not Applicable","develops a design brief, which outlines the analysis of relevant research","develops a design brief, which explains the analysis of relevant research","develops a detailed design brief, which summarizes the analysis of relevant research"]
    }}
  ]},
  B:{name:"Developing Ideas",strands:[
    {t:"Develop A Design Specification",d:{
      MYP1:["states one basic success criterion for a solution","states a few success criteria for the solution","develops a few success criteria for the solution","develops a list of success criteria for the solution"],
      MYP3:["lists a few basic success criteria for the design of a solution","constructs a list of the success criteria for the design of a solution","develops design specifications, which identify the success criteria for the design of a solution","develops a design specification which outlines the success criteria for the design of a solution based on the data collected"],
      MYP5:["lists some basic design specifications for the design of a solution","lists some design specifications, which relate to the success criteria for the design of a solution","develops design specifications, which outline the success criteria for the design of a solution","develops detailed design specifications, which explain the success criteria for the design of a solution based on the analysis of the research"]
    }},
    {t:"Develop Design Ideas",d:{
      MYP1:["presents one design idea, which can be interpreted by others","presents more than one design idea, using an appropriate medium or labels key features, which can be interpreted by others","presents a few feasible design ideas, using an appropriate medium and labels key features, which can be interpreted by others","presents feasible design ideas, using an appropriate medium and outlines the key features, which can be correctly interpreted by others"],
      MYP3:["presents one design idea, which can be interpreted by others","presents a few feasible design ideas, using an appropriate medium or explains key features, which can be interpreted by others","presents a range of feasible design ideas, using an appropriate medium and explains key features, which can be interpreted by others","presents a range of feasible design ideas, using an appropriate medium and annotation, which can be correctly interpreted by others"],
      MYP5:["presents one design, which can be interpreted by others","presents a few feasible designs, using an appropriate medium or annotation, which can be interpreted by others","develops a range of feasible design ideas, using an appropriate medium and annotation, which can be interpreted by others","develops a range of feasible design ideas, using an appropriate medium and detailed annotation, which can be correctly interpreted by others"]
    }},
    {t:"Present the Chosen Design",d:{
      MYP1:["creates an incomplete planning drawing/diagram","states the key features of the chosen design","presents the chosen design stating the key features","presents the chosen design describing the key features"],
      MYP3:["creates incomplete planning drawings/diagrams","outlines the main reasons for choosing the design with reference to the design specification","presents the chosen design and outlines the main reasons for its selection with reference to the design specification","presents the chosen design and outlines the reasons for its selection with reference to the design specification"],
      MYP5:["creates incomplete planning drawings/diagrams","justifies the selection of the chosen design with reference to the design specification","presents the chosen design and justifies its selection with reference to the design specification","presents the chosen design and justifies fully and critically its selection with detailed reference to the design specification"]
    }},
    {t:"Develop Planning Drawings/Diagram",d:{
      MYP1:["Not Applicable","creates a planning drawing/diagram or lists requirements for the creation of the chosen solution","creates a planning drawing/diagram and lists the main details for the creation of the chosen solution","creates a planning drawing/diagram, which outlines the main details for making the chosen solution"],
      MYP3:["Not Applicable","creates planning drawings/diagrams or lists requirements for the chosen solution","develops accurate planning drawings/diagrams and lists requirements for the creation of the chosen solution","develops accurate planning drawings/diagrams and outlines requirements for the creation of the chosen solution"],
      MYP5:["Not Applicable","creates planning drawings/diagrams or lists requirements for the creation of the chosen solution","develops accurate planning drawings/diagrams and lists requirements for the creation of the chosen solution","develops accurate and detailed planning drawings/diagrams and outlines requirements for the creation of the chosen solution"]
    }}
  ]},
  C:{name:"Creating the Solution",strands:[
    {t:"Construct A Logical Plan",d:{
      MYP1:["demonstrates minimal technical skills when making the solution","lists the main steps in a plan that contains some details, resulting in peers having difficulty following","lists the steps in a plan, which considers time and resources, resulting in peers being able to follow","outlines a plan, which considers the use of resources and time, sufficient for peers to be able to follow to create the solution"],
      MYP3:["demonstrates minimal technical skills when making the solution","outlines each step in a plan that contains some details, resulting in peers having difficulty following","constructs a plan, which considers time and resources, sufficient for peers to be able to follow to create the solution","constructs a logical plan, which outlines the efficient use of time and resources, sufficient for peers to follow"],
      MYP5:["demonstrates minimal technical skills when making the solution","constructs a plan that contains some production details, resulting in peers having difficulty following","constructs a logical plan, which considers time and resources, sufficient for peers to be able to follow to create the solution","constructs a detailed logical plan, which describes the efficient use of time and resources, sufficient for peers to follow"]
    }},
    {t:"Demonstrate Technical Skills",d:{
      MYP1:["creates the solution, which functions poorly and is presented in an incomplete form","demonstrates satisfactory technical skills when making the solution","demonstrates competent technical skills when making the solution","demonstrates excellent technical skills when making the solution"],
      MYP3:["creates the solution, which functions poorly and is presented in an incomplete form","demonstrates satisfactory technical skills when making the solution","demonstrates competent technical skills when making the solution","demonstrates excellent technical skills when making the solution"],
      MYP5:["creates the solution, which functions poorly and is presented in an incomplete form","demonstrates satisfactory technical skills when making the solution","demonstrates competent technical skills when making the solution","demonstrates excellent technical skills when making the solution"]
    }},
    {t:"Follow the Plan to Create the Solution",d:{
      MYP1:["Not Applicable","creates the solution, which partially functions and is adequately presented","creates the solution, which functions as intended and is presented appropriately","follows the plan to create the solution, which functions as intended and is presented appropriately"],
      MYP3:["Not Applicable","creates the solution, which partially functions and is adequately presented","creates the solution, which functions as intended and is presented appropriately","follows the plan to create the solution, which functions as intended and is presented appropriately"],
      MYP5:["Not Applicable","creates the solution, which partially functions and is adequately presented","creates the solution, which functions as intended and is presented appropriately","follows the plan to create the solution, which functions as intended and is presented appropriately"]
    }},
    {t:"Justify Changes Made to the Design",d:{
      MYP1:["Not Applicable","states one change made to the chosen design or plan when making the solution","states one change made to the chosen design and plan when making the solution","lists the changes made to the chosen design and plan when making the solution"],
      MYP3:["Not Applicable","outlines changes made to the chosen design or plan when making the solution","outlines changes made to the chosen design and plan when making the solution","explains changes made to the chosen design and plan when making the solution"],
      MYP5:["Not Applicable","outlines changes made to the chosen design and plan when making the solution","describes changes made to the chosen design and plan when making the solution","fully justifies changes made to the chosen design and plan when making the solution"]
    }}
  ]},
  D:{name:"Evaluating",strands:[
    {t:"Design Testing Methods",d:{
      MYP1:["defines a testing method, which is used to measure the success of the solution","defines a relevant testing method, which generates data, to measure the success of the solution","defines relevant testing methods, which generate data, to measure the success of the solution","outlines simple, relevant testing methods, which generate data, to measure the success of the solution"],
      MYP3:["describes a testing method, which is used to measure the success of the solution","describes a relevant testing method, which generates data, to measure the success of the solution","describes relevant testing methods, which generate data, to measure the success of the solution","describes detailed and relevant testing methods, which generate accurate data, to measure the success of the solution"],
      MYP5:["designs a testing method, which is used to measure the success of the solution","designs a relevant testing method, which generates data, to measure the success of the solution","designs relevant testing methods, which generate data, to measure the success of the solution","designs detailed and relevant testing methods, which generate data, to measure the success of the solution"]
    }},
    {t:"Evaluate the Success of the Solution",d:{
      MYP1:["states the success of the solution","states the success of the solution against the design specification based on the results of one relevant test","states the success of the solution against the design specification based on relevant product testing","outlines the success of the solution against the design specification based on authentic product testing"],
      MYP3:["states the success of the solution","outlines the success of the solution against the design specification based on relevant product testing","describes the success of the solution against the design specification based on relevant product testing","explains the success of the solution against the design specification based on authentic product testing"],
      MYP5:["states the success of the solution","outlines the success of the solution against the design specification based on relevant product testing","explains the success of the solution against the design specification based on relevant product testing","critically evaluates the success of the solution against the design specification based on authentic product testing"]
    }},
    {t:"Explain How the Solution Could be Improved",d:{
      MYP1:["Not Applicable","states one way in which the solution could be improved","outlines one way in which the solution could be improved","outlines how the solution could be improved"],
      MYP3:["Not Applicable","lists the ways in which the solution could be improved","outlines how the solution could be improved","describes how the solution could be improved"],
      MYP5:["Not Applicable","outlines how the solution could be improved","describes how the solution could be improved","explains how the solution could be improved"]
    }},
    {t:"Explain the Impact of the Solution",d:{
      MYP1:["Not Applicable","states one way in which the solution can impact the client/target audience","outlines the impact of the solution on the client/target audience, with guidance","outlines the impact of the solution on the client/target audience"],
      MYP3:["Not Applicable","outlines the impact of the solution on the client/target audience","describes the impact of the solution on the client/target audience, with guidance","describes the impact of the solution on the client/target audience"],
      MYP5:["Not Applicable","outlines the impact of the solution on the client/target audience","explains the impact of the solution on the client/target audience, with guidance","explains the impact of the product on the client/target audience"]
    }}
  ]}
};

var ST = {crit:"A",strand:0,grades:{MYP1:true,MYP3:true,MYP5:true},lvls:{1:true,2:true,3:true,4:true},view:"grid"};

function escAttr(s){ return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); }

function hl(txt,lv){
  if(txt==="Not Applicable") return "<em style=\'color:#888;font-weight:800\'>Not Applicable</em>";
  var cls="lv"+lv;
  var keys=Object.keys(CT).sort(function(a,b){return b.length-a.length;});
  var r=txt;
  keys.forEach(function(w){
    var re=new RegExp("\b("+w+")\b","gi");
    r=r.replace(re,function(m){
      return "<span class=\'ct "+cls+"\' data-ct=\'"+w.toLowerCase()+"\' data-lv=\'"+lv+"\'>" + m + "</span>";
    });
  });
  return r;
}

var tipEl=document.getElementById("tip");

// Event delegation for command term hover
document.addEventListener("mouseover",function(e){
  var el=e.target.closest(".ct[data-ct],.cmd-pill[data-ct-lbl]");
  if(!el) return;
  var lv=parseInt(el.dataset.lv)||1;
  if(el.dataset.ct){ showTip(e,el.dataset.ct,lv); }
  else if(el.getAttribute('data-ct-lbl')){ showTipByLbl(e,el.getAttribute('data-ct-lbl'),lv); }
});
document.addEventListener("mouseout",function(e){
  var el=e.target.closest(".ct[data-ct],.cmd-pill[data-ct-lbl]");
  if(el){ hideTip(); }
});
function showTip(e,k,lv){
  var i=CT[k]; if(!i) return;
  var head=document.getElementById("tipHead");
  head.className="tip-head lv"+lv;
  document.getElementById("tipWord").textContent=i.lbl;
  document.getElementById("tipLvl").textContent=LNAME[lv-1]+" level word";
  document.getElementById("tipSimple").textContent=i.s;
  document.getElementById("tipEx").textContent=(i.ex[lv]||i.ex[1]);
  tipEl.className="tip show";
  posTip(e);
}
function hideTip(){tipEl.className="tip";}
document.addEventListener("mousemove",function(e){if(tipEl.className.indexOf("show")>=0)posTip(e);});
function posTip(e){
  var g=16,tw=tipEl.offsetWidth||330,th=tipEl.offsetHeight||140;
  var x=e.clientX+g,y=e.clientY+g;
  if(x+tw>window.innerWidth-8) x=e.clientX-tw-g;
  if(y+th>window.innerHeight-8) y=e.clientY-th-g;
  tipEl.style.left=x+"px"; tipEl.style.top=y+"px";
}

function renderKey(grades,lvls,strand){
  var found={};
  grades.forEach(function(g){
    lvls.forEach(function(l){
      var txt=strand.d[g][l-1];
      Object.keys(CT).forEach(function(w){
        if(new RegExp("\\b"+w+"\\b","i").test(txt)){
          if(!found[l]) found[l]=[];
          var lbl=CT[w].lbl;
          if(found[l].indexOf(lbl)<0) found[l].push(lbl);
        }
      });
    });
  });
  var keys=Object.keys(found);
  if(!keys.length) return "";
  var items="";
  [1,2,3,4].forEach(function(l){
    if(!found[l]) return;
    found[l].forEach(function(lbl){
      var k=Object.keys(CT).find(function(kk){return CT[kk].lbl===lbl;});
      items+="<span class='cmd-pill lv"+l+"' onmouseenter=\"showTipByLbl(event,\'"+escAttr(lbl)+"\',"+l+")\" onmouseleave=\"hideTip()\">"+lbl+"</span>";
    });
  });
  return "<div class='cmd-key fade'><span class='cmd-key-lbl'>Key Words</span><div class='cmd-key-items'>"+items+"</div><span class='cmd-key-hint'>Hover any word to see what it means!</span></div>";
}
function showTipByLbl(e,lbl,lv){
  var k=Object.keys(CT).find(function(kk){return CT[kk].lbl===lbl;});
  if(k) showTip(e,k,lv);
}

// Sidebar wiring
document.querySelectorAll(".crit-btn").forEach(function(btn){
  btn.addEventListener("click",function(){
    ST.crit=btn.dataset.c; ST.strand=0;
    document.querySelectorAll(".crit-btn").forEach(function(b){b.classList.toggle("on",b===btn);});
    buildStrands(); renderMain();
  });
});
function buildStrands(){
  var html="";
  DATA[ST.crit].strands.forEach(function(s,i){
    html+="<button class='strand-btn"+(i===ST.strand?" on":"")+"' data-si='"+i+"'><span class='snum'>"+(i+1)+"</span><span class='stxt'>"+s.t+"</span></button>";
  });
  document.getElementById("strandBtns").innerHTML=html;
  document.querySelectorAll(".strand-btn").forEach(function(btn){
    btn.addEventListener("click",function(){
      ST.strand=parseInt(btn.dataset.si);
      document.querySelectorAll(".strand-btn").forEach(function(b){b.classList.toggle("on",b===btn);});
      renderMain();
    });
  });
}
document.querySelectorAll(".grade-btn").forEach(function(btn){
  btn.addEventListener("click",function(){
    var g=btn.dataset.g;
    var active=Object.values(ST.grades).filter(Boolean).length;
    if(ST.grades[g]&&active===1) return;
    ST.grades[g]=!ST.grades[g];
    btn.classList.toggle("on",ST.grades[g]);
    btn.querySelector(".tbox").textContent=ST.grades[g]?"v":"";
    renderMain();
  });
});
document.querySelectorAll(".lvl-pill").forEach(function(btn){
  btn.addEventListener("click",function(){
    var l=parseInt(btn.dataset.lv);
    var active=Object.values(ST.lvls).filter(Boolean).length;
    if(ST.lvls[l]&&active===1) return;
    ST.lvls[l]=!ST.lvls[l];
    btn.classList.toggle("on",ST.lvls[l]);
    renderMain();
  });
});
document.querySelectorAll(".vbtn").forEach(function(btn){
  btn.addEventListener("click",function(){
    ST.view=btn.dataset.v;
    document.querySelectorAll(".vbtn").forEach(function(b){b.classList.toggle("on",b===btn);});
    renderMain();
  });
});

function renderMain(){
  var main=document.getElementById("mainArea");
  var crit=DATA[ST.crit];
  var strand=crit.strands[ST.strand];
  var grades=Object.entries(ST.grades).filter(function(e){return e[1];}).map(function(e){return e[0];});
  var lvls=Object.entries(ST.lvls).filter(function(e){return e[1];}).map(function(e){return parseInt(e[0]);});
  var col=CCOL[ST.crit], bg=CBG[ST.crit];

  var h="<div class='crumb fade'>Criterion "+ST.crit+" <span class='crumb-sep'>></span> <strong>Strand "+(ST.strand+1)+" - "+strand.t+"</strong></div>";
  h+="<div class='sec-hdr fade'>";
  h+="<div class='crit-tag' style='background:"+bg+";color:"+col+";border-color:"+col+"66'>Criterion "+ST.crit+" - "+crit.name+"</div>";
  h+="<div class='sec-title'>"+strand.t+"</div>";
  h+="<div class='sec-meta'>"+grades.length+" grade level"+(grades.length!==1?"s":"")+" - "+lvls.length+" achievement level"+(lvls.length!==1?"s":"")+" showing</div>";
  h+="</div>";
  h+=renderKey(grades,lvls,strand);

  if(ST.view==="grid"){
    if(!grades.length||!lvls.length){
      h+="<div class='empty'><p>Nothing to show</p><span>Turn on at least one grade and one level in the sidebar!</span></div>";
    } else {
      h+="<div class='grid-view fade'>";
      grades.forEach(function(g){
        lvls.forEach(function(lv){
          var txt=strand.d[g][lv-1];
          h+="<div class='rcard' data-lv='"+lv+"'>";
          h+="<div class='card-top'><span class='card-grade'>"+GLBL[g]+"</span><span class='lvl-badge "+LCLS[lv-1]+"'>"+LBL[lv-1]+"</span></div>";
          h+="<div class='card-txt'>"+hl(txt,lv)+"</div>";
          h+="</div>";
        });
      });
      h+="</div>";
    }
  } else if(ST.view==="table"){
    h+="<div class='tbl-wrap fade'><table><thead><tr><th>Grade Level</th>";
    lvls.forEach(function(l){ h+="<th class='th-lv"+l+"'><span class='tbl-tag lv"+l+"'>"+LBL[l-1]+"</span></th>"; });
    h+="</tr></thead><tbody>";
    grades.forEach(function(g){
      h+="<tr><td>"+GLBL[g]+"</td>";
      lvls.forEach(function(lv){ h+="<td class='td-lv"+lv+"'>"+hl(strand.d[g][lv-1],lv)+"</td>"; });
      h+="</tr>";
    });
    h+="</tbody></table></div>";
  } else {
    h+="<div class='fade'>";
    lvls.forEach(function(lv){
      h+="<div class='cmp-grp'>";
      h+="<div class='cmp-grp-title'><span class='tbl-tag lv"+lv+"'>"+LBL[lv-1]+"</span>Grades compared side by side</div>";
      h+="<div class='cmp-wrap'><div class='cmp-grid' style='grid-template-columns:repeat("+grades.length+",1fr)'>";
      grades.forEach(function(g){ h+="<div class='cmp-hd lv"+lv+"'>"+GLBL[g]+"</div>"; });
      grades.forEach(function(g){ h+="<div class='cmp-cell lv"+lv+"'>"+hl(strand.d[g][lv-1],lv)+"</div>"; });
      h+="</div></div></div>";
    });
    h+="</div>";
  }
  main.innerHTML=h;
}

// Compare modal
document.getElementById("diffBtn").addEventListener("click",function(){
  document.getElementById("cmpBg").classList.add("open");
  document.getElementById("diffBtn").classList.add("active");
});
document.getElementById("cmpClose").addEventListener("click",function(){
  document.getElementById("cmpBg").classList.remove("open");
  document.getElementById("diffBtn").classList.remove("active");
});
document.getElementById("cmpBg").addEventListener("click",function(e){
  if(e.target===this){ document.getElementById("cmpBg").classList.remove("open"); document.getElementById("diffBtn").classList.remove("active"); }
});

function populateSels(){
  var unique=[];
  Object.values(CT).forEach(function(v){ if(unique.indexOf(v.lbl)<0) unique.push(v.lbl); });
  unique.sort();
  function opts(sel){
    return unique.map(function(lbl){
      var k=Object.keys(CT).find(function(kk){return CT[kk].lbl===lbl;});
      return "<option value='"+k+"'"+(k===sel?" selected":"")+">"+(lbl)+"</option>";
    }).join("");
  }
  document.getElementById("sel1").innerHTML=opts("outline");
  document.getElementById("sel2").innerHTML=opts("explain");
  document.getElementById("sel1").addEventListener("change",renderComp);
  document.getElementById("sel2").addEventListener("change",renderComp);
  renderComp();
}

function renderComp(){
  var k1=document.getElementById("sel1").value, k2=document.getElementById("sel2").value;
  var i1=CT[k1], i2=CT[k2]; if(!i1||!i2) return;
  var l1=i1.lv, l2=i2.lv;
  function getUsed(k){
    var uses=[];
    Object.entries(DATA).forEach(function(ce){
      var ck=ce[0],cd=ce[1];
      cd.strands.forEach(function(s,si){
        var all=[];
        Object.values(s.d).forEach(function(arr){arr.forEach(function(d){all.push(d);});});
        if(all.some(function(d){return new RegExp("\\b"+k+"\\b","i").test(d);}))
          uses.push("Crit. "+ck+" - Strand "+(si+1)+": "+s.t);
      });
    });
    return uses.length?uses.slice(0,3).map(function(u){return "<div style='margin-bottom:3px'>- "+u+"</div>";}).join(""):"<em>Not found in this rubric</em>";
  }
  var diff;
  if(l1===l2){
    diff="Both <strong>"+i1.lbl+"</strong> and <strong>"+i2.lbl+"</strong> are <strong>"+LNAME[l1-1]+"</strong> level words - same difficulty! But "+i1.lbl+" means: "+i1.s+" Whereas "+i2.lbl+" means: "+i2.s;
  } else {
    var hi=l1>l2?i1:i2, lo=l1>l2?i2:i1;
    diff="<strong>"+lo.lbl+"</strong> is a <strong>"+LNAME[lo.lv-1]+"</strong> level word: "+lo.s+" <strong>"+hi.lbl+"</strong> is harder - a <strong>"+LNAME[hi.lv-1]+"</strong> level word: "+hi.s+" Just "+lo.lbl.toLowerCase()+"ing is NOT enough when the rubric asks for "+hi.lbl.toLowerCase()+"!";
  }
  document.getElementById("cmpResult").innerHTML=
    "<div class='ccard lv"+l1+"'><div class='ccard-hd'><div class='ccard-word'>"+i1.lbl+"</div><div class='ccard-lvltag'>"+LBL[l1-1]+"</div></div><div class='ccard-body'><div class='ccard-simple'>"+i1.s+"</div><div class='ccard-ex-lbl'>Example at "+LNAME[l1-1]+" level:</div><div class='ccard-ex'>"+(i1.ex[l1]||i1.ex[1])+"</div><div class='ccard-used'><strong>Found in:</strong><br>"+getUsed(k1)+"</div></div></div>"+
    "<div class='ccard lv"+l2+"'><div class='ccard-hd'><div class='ccard-word'>"+i2.lbl+"</div><div class='ccard-lvltag'>"+LBL[l2-1]+"</div></div><div class='ccard-body'><div class='ccard-simple'>"+i2.s+"</div><div class='ccard-ex-lbl'>Example at "+LNAME[l2-1]+" level:</div><div class='ccard-ex'>"+(i2.ex[l2]||i2.ex[1])+"</div><div class='ccard-used'><strong>Found in:</strong><br>"+getUsed(k2)+"</div></div></div>"+
    "<div class='key-diff'><strong>Key Difference:</strong> "+diff+"</div>";
}

// Progression modal
document.getElementById("progBtn").addEventListener("click",function(){
  document.getElementById("progBg").classList.add("open");
  document.getElementById("progBtn").classList.add("active");
  populateProgSelectors();
  renderProg();
});
document.getElementById("progClose").addEventListener("click",function(){
  document.getElementById("progBg").classList.remove("open");
  document.getElementById("progBtn").classList.remove("active");
});
document.getElementById("progBg").addEventListener("click",function(e){
  if(e.target===this){ document.getElementById("progBg").classList.remove("open"); document.getElementById("progBtn").classList.remove("active"); }
});

function populateProgSelectors(){
  var critSel=document.getElementById("progCrit");
  var names={A:"Criterion A - Inquiring and Analyzing",B:"Criterion B - Developing Ideas",C:"Criterion C - Creating the Solution",D:"Criterion D - Evaluating"};
  critSel.innerHTML=Object.entries(names).map(function(e){return "<option value='"+e[0]+"'"+(e[0]===ST.crit?" selected":"")+">"+e[1]+"</option>";}).join("");
  critSel.addEventListener("change",function(){ updateProgStrands(); renderProg(); });
  updateProgStrands();
  document.getElementById("progStrand").addEventListener("change",renderProg);
  document.getElementById("progGrade").addEventListener("change",renderProg);
}

function updateProgStrands(){
  var c=document.getElementById("progCrit").value;
  var strandSel=document.getElementById("progStrand");
  strandSel.innerHTML=DATA[c].strands.map(function(s,i){return "<option value='"+i+"'>"+(i+1)+". "+s.t+"</option>";}).join("");
}

function renderProg(){
  var c=document.getElementById("progCrit").value;
  var si=parseInt(document.getElementById("progStrand").value);
  var g=document.getElementById("progGrade").value;
  var strand=DATA[c].strands[si];
  var notes=(PROG_NOTES[c]&&PROG_NOTES[c][si])||{};
  var exs=(PROG_EX[c]&&PROG_EX[c][si])||{};
  var emojis=["&#128543;","&#128077;","&#128640;","&#127942;"];
  var scores=["1-2","3-4","5-6","7-8"];
  var names=["Not Yet There","Meeting","Exceeding","Excelling"];
  var h="<div class='prog-track'>";
  for(var lv=1;lv<=4;lv++){
    var txt=strand.d[g][lv-1];
    var note=notes[lv]||"";
    var ex=exs[lv]||"";
    var isNA=(txt==="Not Applicable");
    h+="<div class='prog-step'>";
    h+="<div class='prog-spine'><div class='prog-dot lv"+lv+"'>"+emojis[lv-1]+"</div><div class='prog-line lv"+lv+"'></div></div>";
    h+="<div class='prog-content'><div class='prog-card lv"+lv+"'>";
    h+="<div class='prog-card-hd'><div class='prog-lvl-name'>"+names[lv-1]+"</div><div class='prog-score'>"+scores[lv-1]+"</div></div>";
    h+="<div class='prog-card-body'>";
    h+="<div class='prog-rubric'>"+(isNA?"<em style='color:#888'>Not assessed at this level</em>":hl(txt,lv))+"</div>";
    if(note) h+="<div class='prog-changed'><div class='prog-changed-lbl'>"+(lv===1?"Starting point":"What changed from level below")+"</div><div class='prog-changed-txt'>"+note+"</div></div>";
    if(ex&&!isNA) h+="<div class='prog-ex-lbl'>Example student response at this level:</div><div class='prog-ex'>"+ex+"</div>";
    h+="</div></div></div></div>";
    if(lv<4) h+="<div style='text-align:center;font-size:20px;margin:2px 0 6px 26px;color:#888;'>&#8595;</div>";
  }
  h+="</div>";
  document.getElementById("progTrack").innerHTML=h;
}


// ══════════════════════════════════════════════
//  CHECKLIST MODULE
// ══════════════════════════════════════════════
var CL = {crit:null, strand:null, level:null, grade:"MYP5", game:null, checks:[]};

// Checklist task hints — plain English guidance for each rubric descriptor
// keyed: HINTS[crit][strandIdx][level 1-4] = array of task strings
var HINTS = {
  A:{
    0:{
      1:["Write one clear sentence that names the problem your product will solve.",
         "Name who has the problem (your client or target audience).",
         "Check: does your sentence answer 'What is the problem?'"],
      2:["Write 2-3 sentences explaining the main reasons why this problem exists.",
         "Describe who is affected and how it impacts them.",
         "Give at least one real example or piece of evidence that shows the problem is real.",
         "Check: does your reader understand WHY the problem matters, not just what it is?"],
      3:["Write a full paragraph explaining the problem and its causes.",
         "Include context - where, when, and who is affected.",
         "Explain why existing solutions (if any) are not good enough.",
         "Use evidence: a statistic, observation, or quote that proves the need.",
         "Check: does your explanation answer both WHAT the problem is AND WHY it exists?"],
      4:["Write a detailed explanation of the problem with multiple causes and context.",
         "Clearly identify your specific client or target audience and their exact situation.",
         "Provide at least 2 pieces of evidence (survey data, observation, expert opinion).",
         "Justify WHY your solution is needed - explain what would happen if it was not created.",
         "Link every piece of evidence back to the specific need.",
         "Check: could someone read this and be 100% convinced this solution MUST exist?"]
    },
    1:{
      1:["List at least 3 things you need to find out before you start designing.",
         "Write down where you found your information (source names).",
         "Check: are your findings relevant to your design problem?"],
      2:["Write a list of all the research topics you need to investigate.",
         "Mark which research you will do yourself (primary) and which you will find online (secondary).",
         "Put the most important research topic first.",
         "Check: does your list cover user needs, materials, and existing products?"],
      3:["Create a research plan with at least 4 clearly ordered topics.",
         "For each topic, explain WHY it is important to your design.",
         "Label each as primary (e.g. your survey) or secondary (e.g. articles, books).",
         "Put the topics in order from most to least important and explain your ranking.",
         "Check: could you hand this plan to someone else and they would know exactly what research to do?"],
      4:["Create a detailed research plan with at least 5 prioritised topics.",
         "For each topic: name it, say if it is primary or secondary, explain WHY it matters.",
         "Rank all topics from most to least important with a clear written justification for the order.",
         "Explain how each piece of research will directly affect a specific design decision.",
         "Complete all research independently without needing teacher guidance.",
         "Check: does every research topic connect directly to at least one future design choice?"]
    },
    2:{
      1:["Find one existing product similar to what you want to design.",
         "List its main features (size, material, colour, function).",
         "Write one sentence about what you could take inspiration from."],
      2:["Find and describe at least one existing product in detail.",
         "Identify what works well and what does not work well.",
         "Draw or print a picture of the product and label its key features.",
         "Write how this product inspires your own design."],
      3:["Find and describe at least 3 different similar products.",
         "For each product, list: materials, features, price, strengths, and weaknesses.",
         "Compare the products - which features appear in the best ones?",
         "Write a conclusion: what have you learned that will shape your design?",
         "Check: have you covered a range of different types, not just one brand?"],
      4:["Analyse at least 4-5 existing products in depth.",
         "For each product, evaluate: materials, ergonomics, cost, durability, user experience.",
         "Identify patterns - what do ALL the successful products have in common?",
         "Identify gaps - what does NO product currently do well?",
         "Write a conclusion that directly connects your findings to specific design decisions.",
         "Check: does your analysis go beyond describing - does it explain WHY things work or don't?"]
    },
    3:{
      1:["Write 3-4 bullet points summarising your most important research findings.",
         "Make sure each point is directly relevant to your design problem.",
         "Check: do your findings help explain what your product should do or look like?"],
      2:["Write a paragraph that outlines the key findings from your research.",
         "Cover at least 3 different research areas (user needs, existing products, materials).",
         "Keep it focused - only include findings that affect your design.",
         "Check: does your design brief give a clear picture of what is needed?"],
      3:["Write a design brief of at least 3 paragraphs.",
         "Paragraph 1: explain the problem and who it affects.",
         "Paragraph 2: summarise what your research found about user needs and existing products.",
         "Paragraph 3: explain what your product must do based on your research.",
         "Check: does your brief explain the analysis (WHY things matter), not just what you found?"],
      4:["Write a detailed design brief that brings together ALL your research.",
         "Show how each research finding leads to a specific design requirement.",
         "Summarise the most important insights from each research area.",
         "Include a clear statement of purpose: who is the product for, what must it do, and why.",
         "Write it so that someone with no background could read it and understand exactly what needs to be designed.",
         "Check: does your brief summarise AND connect all research - not just list it?"]
    }
  },
  B:{
    0:{
      1:["Write at least one success criterion: 'My product must...'",
         "Make sure it describes something you can test or measure.",
         "Check: if someone read this criterion, would they know what a successful product looks like?"],
      2:["Write at least 4 success criteria using 'My product must...' statements.",
         "Make each criterion specific - avoid vague words like 'good' or 'nice'.",
         "Check: can each criterion be tested? (e.g. must hold 2kg, must cost under $10)",
         "Check: do your criteria come from your research findings?"],
      3:["Write at least 6 measurable design specifications.",
         "For each specification, include HOW you will test it.",
         "Link each specification to a research finding or user need.",
         "Include criteria for: function, materials, size, cost, safety, and aesthetics.",
         "Check: are all criteria testable and specific enough to actually measure?"],
      4:["Write a complete set of detailed design specifications (at least 8).",
         "For each specification: state the requirement, the test method, the target value, and the research source.",
         "Cover all areas: function, safety, ergonomics, cost, sustainability, aesthetics.",
         "Make sure every specification is directly traceable to a research finding.",
         "Check: could a stranger use your specifications to judge whether a product is successful?"]
    },
    1:{
      1:["Draw or make at least one design idea that clearly shows what your product could look like.",
         "Label the main parts of your design.",
         "Check: could someone else look at your design and understand what it is?"],
      2:["Create at least 2 different design ideas (they should look genuinely different).",
         "Label the key features of each design.",
         "Use a clear medium: pencil sketch, CAD, or physical model.",
         "Check: are both designs realistic and possible to actually make?"],
      3:["Create at least 3 clearly different design ideas.",
         "For each design, label ALL key features and briefly explain how it works.",
         "Each design must realistically meet your specifications.",
         "Include dimensions, materials, or colours where relevant.",
         "Check: would someone be able to understand each design without asking you?"],
      4:["Create a range of at least 3-4 well-developed design ideas.",
         "For each design, write detailed annotations explaining every key feature.",
         "Reference which specifications each design meets.",
         "Show design variations or alternatives within each idea.",
         "Check: are your annotations detailed enough that someone else could build from them?"]
    },
    2:{
      1:["Write which design you have chosen.",
         "List the main features of your chosen design.",
         "Produce at least one planning drawing or sketch of your chosen design."],
      2:["Write which design you chose and list its key features clearly.",
         "Give at least 2 reasons why you chose this design over the others.",
         "Reference your design specification in your reasons.",
         "Start a more detailed planning drawing of your chosen design."],
      3:["Write a clear explanation of why you chose this design.",
         "Reference at least 3 specific criteria from your design specification.",
         "Explain what makes this design better than the alternatives.",
         "Include a well-annotated planning drawing showing all key details.",
         "Check: does your justification explain WHY, not just WHAT you chose?"],
      4:["Write a full, critical justification for your chosen design.",
         "Reference EVERY relevant criterion from your design specification.",
         "Explain why this design outperforms all other designs for each criterion.",
         "Include evidence: scores from evaluation, peer feedback, or testing.",
         "Acknowledge any weaknesses in your chosen design and explain how you will address them.",
         "Check: is your justification so strong that no one could argue against your choice?"]
    },
    3:{
      1:["Create a planning drawing OR write a step-by-step list of how to make your product.",
         "Include the main materials you will need.",
         "Check: does your plan show the main parts of making?"],
      2:["Create a planning drawing AND a requirements list.",
         "Your drawing should show the product from at least one angle with labels.",
         "Your requirements list should include all materials and tools needed.",
         "Check: would a classmate be able to start making based on this?"],
      3:["Create accurate planning drawings from multiple angles (front, side, top).",
         "Add dimensions to your drawings (actual measurements).",
         "Write a full materials and tools list with quantities.",
         "Include a step-by-step construction sequence.",
         "Check: could a classmate follow your plan to build your product without asking you?"],
      4:["Create detailed, accurate planning drawings from all relevant angles.",
         "Include all dimensions, tolerances, and material specifications.",
         "Write a detailed requirements list with quantities, costs, and sources.",
         "Write a step-by-step construction plan with time estimates.",
         "Add notes about potential problems and how to solve them.",
         "Check: is your plan complete enough that a stranger could build your product exactly?"]
    }
  },
  C:{
    0:{
      1:["Write a basic list of the main steps to make your product.",
         "Make sure the steps are in the correct order.",
         "Check: does your plan help you know where to start?"],
      2:["Write a step-by-step plan with at least 5 clear steps.",
         "For each step, list the materials or tools you will need.",
         "Check: could a classmate read your plan and follow it (even if with some difficulty)?"],
      3:["Write a detailed plan with clear steps, time estimates, and materials for each step.",
         "Organise your plan so it fits within the time you have.",
         "Make sure a classmate could follow your plan successfully.",
         "Check: does your plan consider BOTH time AND resources efficiently?"],
      4:["Create a logical, detailed production plan (e.g. Gantt chart or table).",
         "Include time estimates for each step and total time.",
         "List all materials, tools, and quantities for each stage.",
         "Show how you will use your time efficiently - no gaps or wasted sessions.",
         "Write notes about contingency (what to do if something goes wrong).",
         "Check: could a peer follow this plan to create your solution independently?"]
    },
    1:{
      1:["Show evidence that you attempted to make your product.",
         "Take photos at different stages of making.",
         "Identify one thing that went well and one thing that was difficult."],
      2:["Complete your product so it is functional (even if not perfect).",
         "Make sure it is presented neatly.",
         "Document your making process with photos or notes.",
         "Check: does your product do what it is supposed to do, at least partially?"],
      3:["Complete your product to a competent standard.",
         "Make sure it functions properly and is presented well.",
         "Show that you used the correct techniques and materials.",
         "Document your making process thoroughly.",
         "Check: does your product meet the functional requirements of your specification?"],
      4:["Complete your product to an excellent standard with high-quality craftsmanship.",
         "Every join, seam, or connection should be neat and strong.",
         "Present your product professionally (clean, finished, well-assembled).",
         "Document your making process in detail including challenges overcome.",
         "Check: does your product demonstrate the best possible use of your skills and materials?"]
    },
    2:{
      1:["Make sure your product is at least partially functional.",
         "Present it as neatly as you can.",
         "Write a sentence explaining what it does and does not do yet."],
      2:["Complete your product so it works as intended.",
         "Present it cleanly and appropriately.",
         "Make sure it matches your planning drawings.",
         "Check: does your product function as you intended when you planned it?"],
      3:["Complete your product so it fully functions as intended.",
         "Present it appropriately and professionally.",
         "Make sure it matches your planning drawings in dimensions and materials.",
         "Check: when you use your product, does it do everything it was designed to do?"],
      4:["Complete your product following your plan step by step.",
         "Verify that your product matches the dimensions and materials in your plan.",
         "Test that it functions exactly as intended.",
         "Present it professionally.",
         "Document how closely your final product matches your original plan.",
         "Check: is the connection between your plan and your product clear and complete?"]
    },
    3:{
      1:["Write down one change you made while making your product.",
         "Explain what the original plan was and what you changed it to.",
         "Check: is it clear what changed and why?"],
      2:["Write down every significant change you made during making.",
         "For each change, explain what the problem was that caused it.",
         "Check: have you covered changes to both the design AND the making plan?"],
      3:["Write a clear record of all changes made during making.",
         "For each change, explain the reason (what problem or opportunity caused it).",
         "Note whether each change improved or affected your product.",
         "Check: is it clear how the change affected both the design AND the plan?"],
      4:["Write a full, justified account of every change made during making.",
         "For each change: describe the original plan, what went wrong or could improve, the change made, and the outcome.",
         "Use evidence where possible (photos, measurements, test results).",
         "Explain how each change brought your product closer to your specification.",
         "Check: does your justification prove that every change was a deliberate, reasoned improvement?"]
    }
  },
  D:{
    0:{
      1:["Write a description of one test you will use to measure if your product works.",
         "Explain what you will do and what result would mean it was successful.",
         "Check: does your test measure something that actually matters?"],
      2:["Design one relevant test that will produce data (numbers or measurable results).",
         "Write exactly how you will carry out the test, step by step.",
         "Say what result would mean your product has passed.",
         "Link your test to at least one specification criterion.",
         "Check: will your test produce data you can actually compare to your target?"],
      3:["Design at least 3 different tests, one for each main specification criterion.",
         "For each test, write: what you will test, how you will do it, what data it generates, and what counts as a pass.",
         "Make sure each test generates measurable data (not just yes/no).",
         "Check: do your tests cover all the key criteria in your specification?"],
      4:["Design a complete testing plan with a test for EVERY specification criterion.",
         "For each test: state the criterion, describe the method in detail, state the target value, and explain how data will be recorded.",
         "Make sure all tests generate quantitative data (numbers).",
         "Include multiple trials for each test to make results reliable.",
         "Check: would your tests give enough data to make a definitive judgement about every criterion?"]
    },
    1:{
      1:["Write whether your product succeeded or failed overall.",
         "Give one piece of evidence that supports your conclusion.",
         "Check: have you said HOW you know it worked or did not work?"],
      2:["Test your product against at least 2 specification criteria.",
         "Record the results of each test.",
         "Say for each criterion: did your product PASS or FAIL, and why?",
         "Check: are your conclusions based on test results, not just opinion?"],
      3:["Test your product against all your specification criteria.",
         "Record results for each test clearly.",
         "For each criterion, explain: what result you got, what the target was, and whether it passed.",
         "Write an overall summary of success.",
         "Check: is your evaluation honest - do you admit where it did not fully succeed?"],
      4:["Critically evaluate your product against every specification criterion.",
         "For each criterion: record test results, compare to target, state pass/partial/fail, and explain why.",
         "Use authentic testing data (real measurements, real user feedback).",
         "Be completely honest - identify every weakness, not just the successes.",
         "Write a final overall judgement that weighs all criteria together.",
         "Check: would a reader trust this evaluation because it is thorough, honest, and evidence-based?"]
    },
    2:{
      1:["Write at least one specific way your product could be made better.",
         "Be specific - not 'make it better' but 'make the handle 2cm longer'.",
         "Check: is your improvement realistic and connected to a real problem you noticed?"],
      2:["Write at least 3 specific improvements you would make to your product.",
         "For each improvement, explain what problem it would fix.",
         "Check: are your improvements connected to the results of your evaluation?"],
      3:["Write a clear improvement plan linked to your evaluation results.",
         "For each improvement: describe exactly what you would change and why.",
         "Prioritise improvements - which ones would make the biggest difference?",
         "Check: is every improvement directly connected to a test that showed a weakness?"],
      4:["Write a detailed, evidence-based improvement plan.",
         "For every criterion that partially failed or fully failed, write a specific, realistic improvement.",
         "For each improvement: explain the problem, describe the solution, and say how it would be tested.",
         "Prioritise improvements by impact and feasibility.",
         "Check: does every improvement directly address a specific failure identified in your evaluation?"]
    },
    3:{
      1:["Write one way your product positively impacts your client or target audience.",
         "Be specific - who benefits and how?",
         "Check: does your impact statement go beyond 'it helps people'?"],
      2:["Write 2-3 ways your product impacts your client or target audience.",
         "For each point, give a specific example or piece of evidence.",
         "Consider both positive impacts and any limitations.",
         "Check: are your impact points connected to your testing results?"],
      3:["Write a detailed explanation of how your product impacts your target audience.",
         "Cover: how it solves the original problem, how users responded to it, and any limitations.",
         "Use evidence from user testing or feedback.",
         "Check: does your explanation go beyond what the product does to explain HOW it affects real people?"],
      4:["Write a comprehensive impact analysis.",
         "Cover: direct impact on the client, broader impact on the target audience, sustainability or ethical considerations.",
         "Use specific evidence: user feedback data, test results, observations.",
         "Acknowledge limitations: who does the product NOT help, or what could still be improved?",
         "Check: does your analysis explain the real-world significance of your solution, not just its features?"]
    }
  }
};

// Game state
var GAME_STATE = {done:0, total:0, type:null};

// Open/close checklist modal
document.getElementById("check-btn-hdr").addEventListener("click", function(){
  document.getElementById("clBg").classList.add("open");
  document.getElementById("check-btn-hdr").classList.add("active");
  // Reset to step 1
  CL = {crit:null, strand:null, level:null, grade:"MYP5", game:null, checks:[]};
  clGoStep(1);
});
document.getElementById("clClose").addEventListener("click", function(){
  document.getElementById("clBg").classList.remove("open");
  document.getElementById("check-btn-hdr").classList.remove("active");
});
document.getElementById("clBg").addEventListener("click", function(e){
  if(e.target===this){ document.getElementById("clBg").classList.remove("open"); document.getElementById("check-btn-hdr").classList.remove("active"); }
});

// Wire choice cards
function wireChoices(containerId, stateKey, nextBtnId, onSelect){
  document.getElementById(containerId).addEventListener("click", function(e){
    var card = e.target.closest(".cl-choice");
    if(!card) return;
    document.querySelectorAll("#"+containerId+" .cl-choice").forEach(function(c){ c.classList.remove("sel"); });
    card.classList.add("sel");
    CL[stateKey] = card.dataset.val;
    document.getElementById(nextBtnId).disabled = false;
    if(onSelect) onSelect(card.dataset.val);
  });
}
wireChoices("clCritChoices", "crit", "clNext1", function(val){
  // Populate strand choices
  var strands = DATA[val].strands;
  var h = "";
  strands.forEach(function(s,i){
    var icons = ["&#128269;","&#128203;","&#128736;","&#128200;"];
    h += "<div class='cl-choice' data-val='"+i+"'><div class='cl-choice-icon'>"+icons[i%4]+"</div><div class='cl-choice-name'>Strand "+(i+1)+"</div><div class='cl-choice-sub'>"+s.t+"</div></div>";
  });
  document.getElementById("clStrandChoices").innerHTML = h;
  CL.strand = null;
  document.getElementById("clNext2").disabled = true;
  wireChoices("clStrandChoices", "strand", "clNext2", null);
});
wireChoices("clLvlChoices", "level", "clNext3", null);
wireChoices("clGameChoices", "game", "clNext4", null);

function clGoStep(n){
  for(var i=1;i<=5;i++) document.getElementById("clStep"+i).classList.toggle("active", i===n);
  document.getElementById("clModalSub").textContent = [
    "Set your goal and choose your game!",
    "Step 1: Choose your Criterion",
    "Step 2: Choose your Strand",
    "Step 3: Set your target level",
    "Step 4: Pick your game",
    "Your personalised checklist!"
  ][n] || "";
}

function clGenerate(){
  var c = CL.crit, si = parseInt(CL.strand), lv = parseInt(CL.level), g = CL.grade||"MYP5";
  var strand = DATA[c].strands[si];
  var tasks = (HINTS[c]&&HINTS[c][si]&&HINTS[c][si][lv]) || [];
  var lvNames = ["Not Yet There","Meeting","Exceeding","Excelling"];
  var lvCls   = ["lv1","lv2","lv3","lv4"];
  var lvScores = ["1-2","3-4","5-6","7-8"];
  var lvEmoji  = ["😟","👍","🚀","🏆"];
  var lvCheer  = [
    "Every journey starts somewhere. Let's get you going!",
    "You're aiming to meet the standard — great start!",
    "You're pushing beyond the basics. That takes courage!",
    "You've challenged yourself to reach the TOP level. Let's go!"
  ];
  // Store checks state
  CL.checks = tasks.map(function(){ return false; });
  GAME_STATE.done = 0;
  GAME_STATE.total = tasks.length;
  GAME_STATE.type = CL.game;

  // Banner
  var bannerIcons = {plant:"🌱",f1:"🏁",animal:"🐾"};
  var bIcon = bannerIcons[CL.game]||"✅";
  var rubricText = strand.d[g][lv-1];

  var h = "";
  // Banner
  h += "<div class='cl-banner "+lvCls[lv-1]+"'>";
  h += "<div class='cl-banner-icon'>"+lvEmoji[lv-1]+"</div>";
  h += "<div class='cl-banner-title'>You've challenged yourself to reach "+lvScores[lv-1]+" — "+lvNames[lv-1]+"!</div>";
  h += "<div class='cl-banner-sub'>"+lvCheer[lv-1]+" "+tasks.length+" tasks to complete.</div>";
  h += "</div>";

  // Rubric quote
  h += "<div style='background:var(--surface2);border-radius:12px;padding:14px 18px;border-left:4px solid var(--"+lvCls[lv-1]+")'>";
  h += "<div style='font-size:11px;font-weight:900;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);margin-bottom:5px;'>The rubric says you must...</div>";
  h += "<div style='font-size:16px;font-weight:800;color:var(--text);line-height:1.6;'>"+rubricText+"</div>";
  h += "</div>";

  // Game widget
  h += "<div class='cl-game'>";
  h += "<div class='cl-game-hdr'><div class='cl-game-title'>"+bIcon+" Your Reward: "+({plant:"Grow a Plant",f1:"F1 Race",animal:"Rescue the Animal"}[CL.game]||"Game")+"</div><div class='cl-game-prog' id='gameProg'>0 / "+tasks.length+" tasks done</div></div>";
  h += "<div class='cl-game-canvas'><canvas id='gameCanvas' width='560' height='110'></canvas></div>";
  h += "</div>";

  // Progress bar
  h += "<div class='cl-progress-wrap'>";
  h += "<div class='cl-progress-label'>Progress</div>";
  h += "<div class='cl-progress-bar'><div class='cl-progress-fill' id='clProgressFill' style='width:0%'></div></div>";
  h += "<div class='cl-progress-pct' id='clProgressPct'>0%</div>";
  h += "</div>";

  // Checklist
  h += "<div class='cl-list' id='clList'>";
  tasks.forEach(function(task, i){
    h += "<div class='cl-item' data-idx='"+i+"'>";
    h += "<div class='cl-checkbox'></div>";
    h += "<div class='cl-item-body'><div class='cl-item-txt'>"+task+"</div></div>";
    h += "</div>";
  });
  h += "</div>";

  document.getElementById("clOutput").innerHTML = h;
  clGoStep(5);

  // Draw initial game frame
  setTimeout(function(){ drawGame(0, tasks.length); }, 100);

  // Wire checklist items
  document.getElementById("clList").addEventListener("click", function(e){
    var item = e.target.closest(".cl-item");
    if(!item) return;
    var idx = parseInt(item.dataset.idx);
    CL.checks[idx] = !CL.checks[idx];
    item.classList.toggle("done", CL.checks[idx]);
    item.querySelector(".cl-checkbox").textContent = CL.checks[idx] ? "✓" : "";
    var done = CL.checks.filter(Boolean).length;
    var pct = Math.round(done/CL.checks.length*100);
    document.getElementById("clProgressFill").style.width = pct+"%";
    document.getElementById("clProgressPct").textContent = pct+"%";
    document.getElementById("gameProg").textContent = done+" / "+CL.checks.length+" tasks done";
    drawGame(done, CL.checks.length);
    if(CL.checks[idx]) fireConfetti();
    if(done===CL.checks.length) clCelebrate();
  });
}

// ── GAME RENDERER ──────────────────────────────────────────────────────────
function drawGame(done, total){
  var canvas = document.getElementById("gameCanvas");
  if(!canvas) return;
  var ctx = canvas.getContext("2d");
  var W=canvas.width, H=canvas.height;
  var pct = total>0 ? done/total : 0;
  ctx.clearRect(0,0,W,H);

  if(GAME_STATE.type==="plant"){
    drawPlantGame(ctx,W,H,pct);
  } else if(GAME_STATE.type==="f1"){
    drawF1Game(ctx,W,H,pct);
  } else if(GAME_STATE.type==="animal"){
    drawAnimalGame(ctx,W,H,pct);
  }
}

function drawPlantGame(ctx,W,H,pct){
  // Sky bg
  var sky=ctx.createLinearGradient(0,0,0,H);
  sky.addColorStop(0,"#e8f5e9"); sky.addColorStop(1,"#c8e6c9");
  ctx.fillStyle=sky; ctx.fillRect(0,0,W,H);
  // Ground
  ctx.fillStyle="#6d4c41"; ctx.fillRect(0,H-20,W,20);
  ctx.fillStyle="#8bc34a"; ctx.fillRect(0,H-24,W,8);
  // Sun
  ctx.fillStyle="#FFD54F";
  ctx.beginPath(); ctx.arc(W-50,35,20,0,Math.PI*2); ctx.fill();

  var cx=W/2, baseY=H-24;
  if(pct<=0){
    // Seed in ground
    ctx.fillStyle="#795548";
    ctx.beginPath(); ctx.ellipse(cx,baseY-4,6,5,0,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#a1887f"; ctx.font="bold 13px Nunito,sans-serif"; ctx.textAlign="center";
    ctx.fillText("Plant your seed... 🌱",cx,H-30);
    return;
  }

  var stemH = Math.max(5, pct*80);
  // Stem
  ctx.strokeStyle="#388e3c"; ctx.lineWidth=5; ctx.lineCap="round";
  ctx.beginPath(); ctx.moveTo(cx,baseY); ctx.lineTo(cx,baseY-stemH); ctx.stroke();

  // Leaves appear progressively
  if(pct>0.2){
    ctx.fillStyle="#66bb6a";
    ctx.beginPath(); ctx.ellipse(cx-18,baseY-stemH*0.35,14,8,-0.5,0,Math.PI*2); ctx.fill();
  }
  if(pct>0.45){
    ctx.fillStyle="#4caf50";
    ctx.beginPath(); ctx.ellipse(cx+18,baseY-stemH*0.6,14,8,0.5,0,Math.PI*2); ctx.fill();
  }
  if(pct>0.7){
    ctx.fillStyle="#81c784";
    ctx.beginPath(); ctx.ellipse(cx-14,baseY-stemH*0.82,10,6,-0.3,0,Math.PI*2); ctx.fill();
  }

  // Flower / bud
  if(pct<0.5){
    ctx.fillStyle="#a5d6a7";
    ctx.beginPath(); ctx.ellipse(cx,baseY-stemH-6,6,8,0,0,Math.PI*2); ctx.fill();
  } else if(pct<0.85){
    // Partial bloom
    ["#ffb300","#ef6c00","#f57c00"].forEach(function(c,i){
      ctx.fillStyle=c;
      ctx.beginPath(); ctx.ellipse(cx+Math.cos(i*1.2)*10,baseY-stemH-6+Math.sin(i*1.2)*10,8,5,i*1.2,0,Math.PI*2); ctx.fill();
    });
    ctx.fillStyle="#ffcc02";
    ctx.beginPath(); ctx.arc(cx,baseY-stemH-6,7,0,Math.PI*2); ctx.fill();
  } else {
    // Full bloom
    for(var a=0;a<6;a++){
      ctx.fillStyle=a%2===0?"#FF80AB":"#F48FB1";
      ctx.beginPath();
      ctx.ellipse(cx+Math.cos(a*Math.PI/3)*13,baseY-stemH-6+Math.sin(a*Math.PI/3)*13,9,6,a*Math.PI/3,0,Math.PI*2);
      ctx.fill();
    }
    ctx.fillStyle="#FFD700";
    ctx.beginPath(); ctx.arc(cx,baseY-stemH-6,9,0,Math.PI*2); ctx.fill();
    // Sparkles
    if(pct>=1){
      ctx.fillStyle="#FFD700";
      [[cx-30,baseY-stemH-25],[cx+28,baseY-stemH-30],[cx,baseY-stemH-38]].forEach(function(p){
        ctx.font="16px serif"; ctx.textAlign="center";
        ctx.fillText("✨",p[0],p[1]);
      });
    }
  }
  // Label
  ctx.fillStyle="#2e7d32"; ctx.font="bold 12px Nunito,sans-serif"; ctx.textAlign="center";
  var labels=["Sprouting...","Growing...","Budding...","Blooming!","Full Flower! 🌸"];
  ctx.fillText(labels[Math.min(4,Math.floor(pct*4.9))],cx,H-6);
}

function drawF1Game(ctx,W,H,pct){
  // Track bg
  var bg=ctx.createLinearGradient(0,0,0,H);
  bg.addColorStop(0,"#f5f5f5"); bg.addColorStop(1,"#e0e0e0");
  ctx.fillStyle=bg; ctx.fillRect(0,0,W,H);
  // Road
  ctx.fillStyle="#424242"; ctx.fillRect(0,H*0.45,W,H*0.35);
  // Dashed centre line
  ctx.strokeStyle="#FFF"; ctx.lineWidth=3; ctx.setLineDash([20,15]);
  ctx.beginPath(); ctx.moveTo(0,H*0.625); ctx.lineTo(W,H*0.625); ctx.stroke();
  ctx.setLineDash([]);
  // Start line
  ctx.fillStyle="#fff"; ctx.fillRect(30,H*0.44,12,H*0.37);
  ctx.fillStyle="#111"; ctx.font="10px Nunito,sans-serif"; ctx.textAlign="center";
  ctx.fillText("START",36,H*0.42);
  // Finish
  ctx.fillStyle="#fff"; ctx.fillRect(W-42,H*0.44,12,H*0.37);
  ctx.fillStyle="#111"; ctx.fillText("FINISH",W-36,H*0.42);
  // Chequered finish block
  var fx=W-42;
  for(var row=0;row<6;row++) for(var col=0;col<2;col++){
    if((row+col)%2===0){ ctx.fillStyle="#111"; ctx.fillRect(fx+col*6,H*0.44+row*7,6,7); }
  }
  // Crowd stands
  ctx.fillStyle="#bdbdbd"; ctx.fillRect(0,0,W,H*0.35);
  ctx.fillStyle="#9e9e9e"; ctx.fillRect(0,H*0.35,W,10);
  // Simple crowd dots
  for(var ci=0;ci<30;ci++){
    var colors=["#e53935","#1e88e5","#43a047","#fb8c00","#8e24aa"];
    ctx.fillStyle=colors[ci%5];
    ctx.beginPath(); ctx.arc(20+ci*18+(ci%3)*4, 30+(ci%4)*16, 5,0,Math.PI*2); ctx.fill();
  }
  // Car position
  var carX = 45 + pct*(W-110);
  var carY = H*0.52;
  // Shadow
  ctx.fillStyle="rgba(0,0,0,0.2)"; ctx.beginPath(); ctx.ellipse(carX+18,carY+28,22,6,0,0,Math.PI*2); ctx.fill();
  // Car body
  ctx.fillStyle="#e53935"; ctx.beginPath();
  ctx.roundRect(carX,carY+6,36,14,4); ctx.fill();
  // Cockpit
  ctx.fillStyle="#1a1a2e";
  ctx.beginPath(); ctx.roundRect(carX+10,carY,16,10,3); ctx.fill();
  // Wheels
  ctx.fillStyle="#111";
  [[carX+4,carY+20],[carX+28,carY+20]].forEach(function(w){
    ctx.beginPath(); ctx.arc(w[0],w[1],6,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#555"; ctx.beginPath(); ctx.arc(w[0],w[1],3,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#111";
  });
  // Speed lines when moving
  if(pct>0.05){
    ctx.strokeStyle="rgba(255,255,255,0.6)"; ctx.lineWidth=2;
    [8,14,20].forEach(function(offset){
      ctx.beginPath(); ctx.moveTo(carX-5,carY+offset); ctx.lineTo(carX-18,carY+offset); ctx.stroke();
    });
  }
  // Number
  ctx.fillStyle="#fff"; ctx.font="bold 9px Nunito,sans-serif"; ctx.textAlign="center";
  ctx.fillText("44",carX+18,carY+16);
  // Label
  ctx.fillStyle="#212121"; ctx.font="bold 12px Nunito,sans-serif"; ctx.textAlign="center";
  var speed=["Ready on the grid...","Accelerating!","Mid-race, pushing hard!","Almost there!","FINISH LINE! 🏆"][Math.min(4,Math.floor(pct*4.9))];
  ctx.fillText(speed,W/2,H-6);
  // Finish flag celebration
  if(pct>=1){
    ctx.font="22px serif"; ctx.textAlign="center";
    ctx.fillText("🏁",W-36,H*0.35);
    ctx.fillText("🎉",carX+18,carY-10);
  }
}

function drawAnimalGame(ctx,W,H,pct){
  // Vet room bg
  var bg=ctx.createLinearGradient(0,0,0,H);
  bg.addColorStop(0,"#e3f2fd"); bg.addColorStop(1,"#bbdefb");
  ctx.fillStyle=bg; ctx.fillRect(0,0,W,H);
  // Floor
  ctx.fillStyle="#fff8e1"; ctx.fillRect(0,H*0.72,W,H*0.28);
  ctx.strokeStyle="#ffe082"; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(0,H*0.72); ctx.lineTo(W,H*0.72); ctx.stroke();
  // Table / bed
  ctx.fillStyle="#a1887f"; ctx.fillRect(W/2-80,H*0.55,160,10);
  ctx.fillStyle="#d7ccc8"; ctx.fillRect(W/2-80,H*0.58,160,30);

  // --- Koala on the bed ---
  var bx=W/2, by=H*0.52;
  // Body
  ctx.fillStyle="#9e9e9e";
  ctx.beginPath(); ctx.ellipse(bx,by+22,22,18,0,0,Math.PI*2); ctx.fill();
  // Head
  ctx.fillStyle="#9e9e9e";
  ctx.beginPath(); ctx.arc(bx,by,20,0,Math.PI*2); ctx.fill();
  // Ears
  ctx.fillStyle="#9e9e9e";
  ctx.beginPath(); ctx.ellipse(bx-18,by-16,10,9,-.4,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.ellipse(bx+18,by-16,10,9,.4,0,Math.PI*2); ctx.fill();
  ctx.fillStyle="#f8bbd0";
  ctx.beginPath(); ctx.ellipse(bx-18,by-16,6,5,-.4,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.ellipse(bx+18,by-16,6,5,.4,0,Math.PI*2); ctx.fill();
  // Nose
  ctx.fillStyle="#555";
  ctx.beginPath(); ctx.ellipse(bx,by+3,7,5,0,0,Math.PI*2); ctx.fill();

  // Bandages / health indicators
  var bandageCount = Math.floor(pct*4);
  if(bandageCount>=1){ // Arm bandage off
    ctx.strokeStyle="#ef9a9a"; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(bx-22,by+18); ctx.lineTo(bx-32,by+30); ctx.stroke();
  } else {
    // Bandaged arm
    ctx.fillStyle="#fff"; ctx.fillRect(bx-34,by+20,14,8);
    ctx.strokeStyle="#ef9a9a"; ctx.lineWidth=1.5;
    ctx.beginPath(); ctx.moveTo(bx-34,by+24); ctx.lineTo(bx-20,by+24); ctx.stroke();
  }

  // Eyes change with health
  var eyeColor = pct<0.3?"#999":(pct<0.6?"#5d4037":"#1a237e");
  var eyeSize  = pct<0.3?2.5:(pct<0.6?3.5:4.5);
  ctx.fillStyle=eyeColor;
  ctx.beginPath(); ctx.arc(bx-8,by-2,eyeSize,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.arc(bx+8,by-2,eyeSize,0,Math.PI*2); ctx.fill();
  // Eye shine
  if(pct>0.4){
    ctx.fillStyle="#fff";
    ctx.beginPath(); ctx.arc(bx-6,by-4,1.5,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(bx+10,by-4,1.5,0,Math.PI*2); ctx.fill();
  }

  // Smile
  ctx.strokeStyle=pct<0.3?"#aaa":"#5d4037"; ctx.lineWidth=2; ctx.lineCap="round";
  ctx.beginPath();
  if(pct<0.25){ // Sad
    ctx.arc(bx,by+10,7,0.3,Math.PI-0.3,true);
  } else if(pct<0.7){ // Neutral
    ctx.moveTo(bx-6,by+10); ctx.lineTo(bx+6,by+10);
  } else { // Happy
    ctx.arc(bx,by+6,7,0.2,Math.PI-0.2);
  }
  ctx.stroke();

  // IV drip / cast healing away
  if(pct<0.4){
    // IV pole
    ctx.strokeStyle="#90a4ae"; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(bx+80,H*0.2); ctx.lineTo(bx+80,H*0.62); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(bx+65,H*0.22); ctx.lineTo(bx+95,H*0.22); ctx.stroke();
    // IV bag
    ctx.fillStyle="#b3e5fc"; ctx.fillRect(bx+62,H*0.22,26,18); ctx.strokeStyle="#4fc3f7"; ctx.lineWidth=2; ctx.strokeRect(bx+62,H*0.22,26,18);
    // Drip line
    ctx.strokeStyle="#4fc3f7"; ctx.lineWidth=1.5; ctx.setLineDash([3,3]);
    ctx.beginPath(); ctx.moveTo(bx+75,H*0.4); ctx.lineTo(bx+75,H*0.62); ctx.stroke();
    ctx.setLineDash([]);
  }

  // Heart rate monitor at higher health
  if(pct>0.5){
    ctx.strokeStyle=pct>0.8?"#4caf50":"#ef9a9a"; ctx.lineWidth=2;
    var mx=bx-60, my=by+45;
    ctx.beginPath(); ctx.moveTo(mx,my); ctx.lineTo(mx+10,my); ctx.lineTo(mx+14,my-12); ctx.lineTo(mx+18,my+8);
    ctx.lineTo(mx+22,my); ctx.lineTo(mx+32,my); ctx.stroke();
  }

  // Healing glow at high pct
  if(pct>0.8){
    var grd=ctx.createRadialGradient(bx,by,5,bx,by,40);
    grd.addColorStop(0,"rgba(200,255,200,0.4)"); grd.addColorStop(1,"rgba(200,255,200,0)");
    ctx.fillStyle=grd; ctx.beginPath(); ctx.arc(bx,by,40,0,Math.PI*2); ctx.fill();
  }

  // Hearts at full health
  if(pct>=1){
    ctx.font="18px serif"; ctx.textAlign="center";
    ctx.fillText("💚",bx-35,by-25);
    ctx.fillText("💚",bx+35,by-25);
    ctx.fillText("💚",bx,by-40);
  }

  // Status label
  var labels=["Our koala is hurt... 😔","Getting a little better 🩺","Healing well! 💊","Almost fully healed! 🌿","Fully recovered! 💚🌟"][Math.min(4,Math.floor(pct*4.9))];
  ctx.fillStyle="#1a237e"; ctx.font="bold 12px Nunito,sans-serif"; ctx.textAlign="center";
  ctx.fillText(labels, W/2, H-6);
}

// ── CONFETTI ────────────────────────────────────────────────────────────────
function fireConfetti(){
  var colours=["#FF80AB","#69F0AE","#40C4FF","#FFD740","#E040FB","#FF6D00"];
  for(var i=0;i<18;i++){
    var el=document.createElement("div");
    el.className="confetti-piece";
    el.style.cssText="left:"+(30+Math.random()*40)+"%;top:"+( Math.random()*30+30)+"%;width:"+(6+Math.random()*8)+"px;height:"+(6+Math.random()*8)+"px;background:"+colours[Math.floor(Math.random()*colours.length)]+";animation-delay:"+(Math.random()*0.4)+"s;";
    document.body.appendChild(el);
    setTimeout(function(e){ e.remove(); }, 1800, el);
  }
}

function clCelebrate(){
  for(var i=0;i<5;i++) setTimeout(fireConfetti, i*200);
  var banner=document.querySelector(".cl-banner");
  if(banner) banner.style.transform="scale(1.04)";
  setTimeout(function(){ if(banner) banner.style.transform=""; },300);
}

function clPrint(){
  window.print();
}


// ── MODE SWITCHER ──
document.getElementById("modeRubric").addEventListener("click", function(){
  document.getElementById("modeRubric").classList.add("on");
  document.getElementById("modeLearn").classList.remove("on");
  document.getElementById("panelRubric").style.display = "";
  document.getElementById("panelLearn").style.display = "none";
});
document.getElementById("modeLearn").addEventListener("click", function(){
  document.getElementById("modeLearn").classList.add("on");
  document.getElementById("modeRubric").classList.remove("on");
  document.getElementById("panelRubric").style.display = "none";
  document.getElementById("panelLearn").style.display = "block";
});

// ── LEARN NAV ──
document.querySelectorAll(".learn-nav-btn").forEach(function(btn){
  btn.addEventListener("click", function(){
    document.querySelectorAll(".learn-nav-btn").forEach(function(b){ b.classList.remove("on"); });
    btn.classList.add("on");
    var sec = btn.dataset.sec;
    document.querySelectorAll(".learn-section").forEach(function(s){ s.classList.remove("on"); });
    var target = document.getElementById("sec-"+sec);
    if(target) target.classList.add("on");
  });
});

// ── AI ACCORDION ──
function toggleAI(hdr){
  hdr.classList.toggle("open");
}

function init(){
  buildStrands();
  renderMain();
  populateSels();
}
init();
</script>
</body>
</html>
